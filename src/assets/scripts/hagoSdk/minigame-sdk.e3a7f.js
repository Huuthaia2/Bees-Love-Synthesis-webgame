!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("crypto")):"function"==typeof define&&define.amd?define(["crypto"],t):t(e.crypto)}(this,function(e){"use strict";function t(e,t,s,n){return new(s=s||Promise)(function(i,r){function o(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})}e=e&&e.hasOwnProperty("default")?e.default:e;const s={OK:"OK",UNSUPPORTED_API:"UNSUPPORTED_API",TIMEOUT:"TIMEOUT",INVALID_PARAM:"INVALID_PARAM",NOT_READY:"NOT_READY",ADS_NO_FILL:"ADS_NO_FILL",AD_LOAD_FAILED:"AD_LOAD_FAILED",AD_DISMISSED:"AD_DISMISSED",AD_NOT_LOADED:"AD_NOT_LOADED",AD_ALREADY_LOADED:"AD_ALREADY_LOADED",AD_ALREADY_SHOWED:"AD_ALREADY_SHOWED"},n={CODE:s,OK:{code:s.OK,message:"Success"},TIMEOUT:{code:s.TIMEOUT,message:"timeout"},adLoadFail:{code:s.AD_LOAD_FAILED,message:"Ad load failed"},adDismissed:{code:s.AD_DISMISSED,message:"Ad dismissed"},adNotLoaded:{code:s.AD_NOT_LOADED,message:"Ad not loaded"},adAlreadyLoaded:{code:s.AD_ALREADY_LOADED,message:"Ad already loaded"},adAlreadyShowed:{code:s.AD_ALREADY_SHOWED,message:"Ad already showed"}};var i,r,o,a;function c(e){return t(this,void 0,void 0,function*(){return new Promise(function(t,s){s(e)})})}(Gt=i=i||{}).emptyWait=function(e){return t(this,void 0,void 0,function*(){return new Promise(function(t,s){e?s(new Error("Failed by design")):t()})})},Gt.emptyWaitObject=function(e){return t(this,void 0,void 0,function*(){return new Promise(function(t){t(e)})})},Gt.emptyWaitBool=function(e){return t(this,void 0,void 0,function*(){return new Promise(function(t){t(e)})})},Gt.emptyWaitString=function(e){return t(this,void 0,void 0,function*(){return new Promise(function(t){t(e)})})},Gt.emptyWaitError=c,Gt.emptyWaitUnsupportApi=function(e){return t(this,void 0,void 0,function*(){return c((t=e,{code:n.CODE.UNSUPPORTED_API,message:"unsupport api:"+t}));var t})},Gt.generateId=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)};class d{constructor(e=null,t="SOLO"){this._sId=e,this._sType=t}static get currentContext(){return this._currentContext||(this._currentContext=new d),this._currentContext}static set currentContext(e){this._currentContext=e}getID(){return this._sId}getType(){return this._sType}isSizeBetween(e,t){return{answer:!1,minSize:e||0,maxSize:t||0}}switchAsync(e){return this._sId=e,i.emptyWaitObject(null)}chooseAsync(e){return i.emptyWaitUnsupportApi("context.chooseAsync")}createAsync(e){return i.emptyWaitUnsupportApi("context.createAsync")}getPlayersAsync(){return i.emptyWaitObject([])}}let l="_minigame_data_",h={},u=!1;function m(e,t){if(null==e||""===e.trim())throw{code:n.CODE.INVALID_PARAM,message:"Invalid key: "+e};return void 0!==(e=h[e])?e:t}function p(e,t){if(null==e||""===e.trim())throw{code:n.CODE.INVALID_PARAM,message:"Invalid key: "+e};h[e]=t}function g(){try{var e=JSON.stringify(h);localStorage.setItem(l,e),localStorage.flush&&localStorage.flush()}catch(e){console.error("LocalCache.flush error: ",e)}}class y{constructor(){this._configUrl="",this._gameId="",this._appId="",this._channel="",this._channelName="",this._minigameOption=null,this._playPageData=null,this._locationSearch=""}get configUrl(){return this._configUrl}get gameId(){return this._gameId}get appId(){return this._appId}get channel(){return this._channel}get channelName(){return this._channelName}get minigameOption(){return this._minigameOption}get playPageData(){return this._playPageData}set playPageData(e){this._playPageData=e}get locationSearch(){return this._locationSearch=window.location.search,this._locationSearch}static get instance(){return this._instance||(this._instance=new y),this._instance}init(e){this._channel=this.getSubChannelName(),this._channelName=this.getChannelName(),this._minigameOption=e,this._gameId=`${e.game_id}`,this._appId=`${e.app_id}`,this._locationSearch=window.location.search,window.commonInfo=y}getChannelName(){return window.globalPlatformInfo.channelName||window.channelName||this._playPageData.channelName}getSubChannelName(){return window.globalPlatformInfo.subChannelName||window.subChannelName||this._playPageData.subChannelName}getGameManifestJsonUrl(){return this._playPageData.gameManifestJsonUrl}isH5AndroidApp(){return this._minigameOption?this._minigameOption.android?this._minigameOption.android.enabled:(console.warn("minigame config has not android field!!!"),!1):(console.warn("minigame config is not exist!!!"),!1)}isAdflyEnable(){return this._minigameOption?this._minigameOption.cpl?this._minigameOption.cpl.adflyer?this._minigameOption.cpl.adflyer.enabled:(console.warn("cpl config has not adflyer field!!!"),!1):(console.warn("minigame config has not cpl field!!!"),!1):(console.warn("minigame config is not exist!!!"),!1)}getAdflyChannelID(){return this.isAdflyEnable()?this._minigameOption.cpl.adflyer.channelId:""}}y._instance=null;const f=y.instance,w={addCallbackEvent(e){e&&0<e.length&&e.forEach(e=>{e.ele&&e.ele.addEventListener(e.eventName,t=>{e.eventFunc&&e.eventFunc(t)})})},createDailogContainer(){let e=document.getElementById("minigameDailogContainer");return e||((e=document.createElement("div")).setAttribute("id","minigameDailogContainer"),e.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;top:0;  z-index: 20000; overflow: hidden; width: 100vw;height: 100vh; background-color: rgb(0, 0, 0,0.6);"),document.body.append(e)),e},removeDailogContainer(e){const t=document.getElementById("minigameDailogContainer");t&&t.childNodes&&t.childNodes.length<=1?t&&t.remove():e&&e instanceof Function&&e()}};let A;function v(e,t){var s,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");const i=[];let r;if(t=t||n.length,e)for(r=0;r<e;r++)i[r]=n[0|Math.random()*t];else for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",r=0;r<36;r++)i[r]||(s=0|16*Math.random(),i[r]=n[19===r?3&s|8:s]);return i.join("")}class _{static getTimestamp(){return(new Date).getTime()}static getTimeBySecond(){return Math.floor((new Date).getTime()/1e3)}static getDate(){return(new Date).toLocaleDateString()}static getTargetTimestamp(e=0,t=0,s=0){var n=new Date((new Date).toLocaleDateString()).getTime();return new Date(n+1e3*(3600*e+60*t+s)).getTime()}static waitTime(e,t){return new Promise(s=>{setTimeout(()=>{t&&t(),s()},e)})}}(Ft=r=r||{}).json="application/json",Ft.form="application/x-www-form-urlencoded; charset=UTF-8",(Ut=o=o||{}).get="GET",Ut.post="POST";const b=new class{constructor(){this.handleUrl=e=>t=>{if(t){const s=[];Object.keys(t).forEach(e=>s.push(e+"="+encodeURIComponent(t[e]))),-1===e.search(/\?/)?"object"==typeof t&&(e+="?"+s.join("&")):e+="&"+s.join("&")}return e}}getFetch(e,s,n){return t(this,void 0,void 0,function*(){return n={method:o.get,headers:{"Content-Type":r.json}},yield fetch(this.handleUrl(e)(s),n).then(e=>e.ok?e.json():Promise.reject("request failed with status "+e.status)).then(e=>e).catch(t=>Promise.reject(`get ${e} fail`+t.message))})}postFetch(e,s){return t(this,void 0,void 0,function*(){const t=new FormData;Object.keys(s).forEach(e=>t.append(e,s[e]));const n=new Headers;n.append("Content-Type","application/json");var i={method:o.post,headers:n,body:JSON.stringify(s),redirect:"follow"};return yield fetch(e,i).then(t=>t.ok?t.json():Promise.reject({code:t.status,message:`post ${e} fail status: ${t.status}`})).then(t=>(console.info(`post ${e} success response: ${JSON.stringify(t)}`),t)).catch(t=>Promise.reject({code:"server error",message:`post ${e} fail`+t.message}))})}};function S(e,s){return t(this,void 0,void 0,function*(){return b.postFetch(e,s)})}function P(e,s,n=3){return t(this,void 0,void 0,function*(){return n<3&&(yield _.waitTime(1e3)),S(e,s).then(e=>Promise.resolve(e)).catch(t=>0<n?(console.error(`post ${e} retry ${n} times`),P(e,s,n-1)):Promise.reject({code:"fetch retry failed",message:`post ${e} fail`+t}))})}class x{}x.PAY_IP="https://purchase2.minigame.vip",x.MINI_ORDER_ID="v2/purchase/miniorder",x.SET_DATA="v1/archive",x.GET_DATA="v1/archive",x.STORAGE_IP="https://storage.minigame.vip:30443";class I{}I.ADS_NETWORK_NOT_FOUND="ADS_NETWORK_NOT_FOUND";class k{}k.DOMAIN="https://ingress.minigame.vip:30443",k.API_PATH="/v1/mam/api/mda/random",k.BATCH_API_PATH="/v1/mam/api/mda/batch_random",(Ht=$t=$t||{})[Ht.AdTypeEnumNull=0]="AdTypeEnumNull",Ht[Ht.Display=1]="Display",Ht[Ht.Float=2]="Float",Ht[Ht.Banner=3]="Banner",Ht[Ht.Interstitial=4]="Interstitial",Ht[Ht.Rewarded=5]="Rewarded",(Wt=a=a||{}).WAITING="0",Wt.PAYING="1",Wt.SUCCESS="2";class T{constructor(){this._curProducts=[],this._curProductInfos=[]}static getInstance(){return this._instance||(this._instance=new T),this._instance}init(e){return t(this,void 0,void 0,function*(){T._instance=this;try{emoPaySDK.api.initSDK(e),console.info("inititial emo pay sdk success")}catch(t){return M.showWithInit("OK","Payment initialization failed"),Promise.reject({code:"emoPay init fail",message:t.message})}try{var t=yield this.query();return this._curProducts.length=0,this._curProducts=this._curProducts.concat(t),console.info("query goods info: ",this._curProducts),Promise.resolve()}catch(t){return Promise.reject({code:"query goods fail",message:t.message})}})}pay(e,s){return t(this,void 0,void 0,function*(){let t=!1;try{t=yield this.checkLoginAsync()}catch(t){return M.showWithInit("OK","Network error, please check \nif the network is available"),Promise.reject({code:"pay error",message:t.message})}if(!t)return M.showWithInit("Login","You are currently not logged in, \nor the token has expired, \nplease log in again",()=>{O.show()}),Promise.reject({code:"login error",message:"without login, please login frist."});try{const i={};i.orderNo=s||v(),i.productId=e;var n=yield this.buyGoods(i);const r={paymentID:"",signedRequest:""};return r.productID=e,r.purchaseTime=n.paidTime,r.purchaseToken=n.cpOrderNo,Promise.resolve(r)}catch(t){return M.showWithInit("OK","Payment failed, please pay again"),Promise.reject({code:"pay fail",message:t.message})}})}query(){return new Promise((e,t)=>{emoPaySDK.api.requestGoods(s=>{0!==s.code&&t({code:"request goods fail",message:s.msg}),null!=s.data&&0!==s.data.length||t({code:"request goods empty",message:"request goods empty"});const n=[],i=s.data;this._curProductInfos=i,i.forEach(e=>{const t={};t.title=e.goodsName,t.price=`${e.amount}`,t.productID=e.goodsId,t.description=e.goodsExp,t.priceCurrencyCode="",t.imageURI="",n.push(t)}),e(n)})})}queryUncomsume(){return t(this,void 0,void 0,function*(){try{var e=yield P(`${x.PAY_IP}/${x.MINI_ORDER_ID}/query`,{thirdUid:emoPaySDK.api.getUserId()});console.log("query uncomsume orderInfos: ",e);const t=e.paidMiniOrders,s=[];return t.forEach(e=>{var t=this._curProducts.filter(t=>t.productID===e.productId)[0];const n={paymentID:"",purchaseTime:""};n.productID=t.productID,n.purchaseToken=e.thirdOrderId,n.signedRequest="",s.push(n)}),Promise.resolve(s)}catch(e){return Promise.reject({code:"query uncomsume order",message:e.message})}})}consume(e){return t(this,void 0,void 0,function*(){try{return yield P(`${x.PAY_IP}/${x.MINI_ORDER_ID}/consume`,{mini_order_id:e}),Promise.resolve()}catch(e){return Promise.reject({code:"consume_fail",message:e.message})}})}onReady(e){}checkUserLoginStatus(){return new Promise((e,t)=>{emoPaySDK.api.checkUserLoginStatus(s=>{0===s?e(!0):-1===s||-2===s?e(!1):t({code:"check user login status error",message:JSON.stringify(s)})})})}buyGoods(e){return console.info("=====> pay options: ",e),new Promise((t,s)=>{var n,i=this._curProductInfos.filter(t=>t.goodsId===e.productId)[0];null!=i?(n={game_id:f.gameId},n=JSON.stringify(n),console.info("=====> emoPay buyGoods ing"),emoPaySDK.api.buyGoods(i,e.orderNo,n,"http://purchase.minigame.vip/v2/purchase/emo/callback",e=>{console.info("emoPay buyGoods response: ",e),0===e.code&&null!=e.data?e.data.paySt===a.SUCCESS?(console.info("pay success"),t(e.data)):(console.info("pay fail"),s({code:"pay fail",message:e.msg})):s({code:"buy goods fail",message:e.msg})})):s({message:"product not found"})})}guestLogin(){return new Promise((e,t)=>{emoPaySDK.api.guestLogin(s=>{0===s.code?(console.info("guest login success"),e()):(console.info("guest login fail"),t({code:"guest login fail",message:s.msg}))})})}sendVerifyCode(e){return new Promise((t,s)=>{emoPaySDK.api.requestOpt(e,e=>{0===e.code?t():s({code:"send verify code fail",message:e.msg})})})}phoneLogin(e,t){return new Promise((s,n)=>{emoPaySDK.api.phoneLogin(e,t,e=>{0===e.code?s():n({code:"phone login fail",message:e.msg})})})}userLogin(e,t){return this.phoneLogin(e,t)}getUserId(){return emoPaySDK.api.getUserId()||""}getUserToken(){return emoPaySDK.api.getUserToken()}checkLoginAsync(){return t(this,void 0,void 0,function*(){try{var e=yield this.checkUserLoginStatus();return e&&Y.storageType!==U.Cloud||!e?Promise.resolve(!1):Promise.resolve(!0)}catch(e){return Promise.reject({code:"check Login error",message:e.message})}})}}const C=T.getInstance(),R={};R.EmoPay=T;let B=document;function D(e,s=!1,n){return t(this,void 0,void 0,function*(){return new Promise((t,i)=>{const r=B.createElement("script");if(r.src=e,r.async=s,n)for(const e in n)r.setAttribute(e,n[e]);const o=()=>{r.removeEventListener("load",o),t()};r.addEventListener("load",o),r.addEventListener("error",t=>{console.error(t),i(new Error(`Failed to load ${e}`))}),(B.getElementsByTagName("head")[0]||document.documentElement).appendChild(r)})})}const E=class e{constructor(){this._payPlatormInfo=null,this._curPayment=null,this._isPayEnable=!1,this._inited=!1}static get instance(){return this._instance||(this._instance=new e),this._instance}set payEnable(e){this._isPayEnable=e}get payEnable(){return this._isPayEnable}get inited(){return this._inited}init(e){throw new Error("Method not implemented.")}pay(e,t){return console.info("=====> pay productID: ",e),this._inited?this._curPayment?this._curPayment.pay(e,t):(console.error("purchase fail no payment selected"),Promise.reject({code:"purchaseAsync fail",message:"no payment selected"})):(M.showWithInit("OK","The payment initialization failed. \nPlease restart the game if you \nwant to make a payment."),Promise.reject({code:"fail to initialize payment",message:"payment inited false"}))}query(){return t(this,void 0,void 0,function*(){if(!this._curPayment)return Promise.reject({code:"getCatalogAsync fail",message:"no payment selected"});try{var e=yield this._curPayment.query();return console.info("get products : ",e),e}catch(e){return Promise.reject({message:"getCatalog fail "+e.message})}})}queryUncomsume(){return this._curPayment?this._curPayment.queryUncomsume():Promise.reject({code:"getPurchasesAsync fail",message:"no payment selected"})}consume(e){return this._curPayment?this._curPayment.consume(e):Promise.reject({code:"consumePurchaseAsync fail",message:"no payment selected"})}onReady(e){this._curPayment?this._curPayment.onReady(e):console.error("no payment selected")}fetchPayConfig(e){return t(this,void 0,void 0,function*(){try{const s=yield fetch(e);if(404===s.status)return Promise.reject({code:"fetchPayConfig fail "+e});var t=(yield s.json()).infos.filter(e=>e.enabled)[0];return this._curPayment=class{static getClass(e,t){return void 0===R[e]||null===R[e]?(console.warn(`\u672a\u627e\u5230 className\uff1a${e} \u5bf9\u5e94\u5b9e\u73b0`),null):new R[e](t)}static checkValidClass(e){return void 0===R[e]||null===R[e]?null:e}}.getClass(t.id),this._payPlatormInfo=t,this._curPayment?(console.info("load pay config: ",e),this._isPayEnable=!0,Promise.resolve()):Promise.reject({code:"this._curPayment null "+t.id})}catch(t){return Promise.reject({message:"fetchPayConfig fail "+t.message})}})}loadSDK(){return t(this,void 0,void 0,function*(){try{return yield D(this._payPlatormInfo.sdkUrl,!0),console.info("load pay dk: ",this._payPlatormInfo.sdkUrl),Promise.resolve()}catch(F){return Promise.reject({message:"load pay sdk fail "+F.message})}})}loadPayment(e){return t(this,void 0,void 0,function*(){try{return yield this.fetchPayConfig(e),yield this.loadSDK(),this._curPayment.init(this._payPlatormInfo.channel),this._inited=!0,Promise.resolve()}catch(e){return Promise.reject({code:"loadPayment fail",message:e.message})}})}setPayment(e){e?this._curPayment=e:console.error("payment is null")}getUserId(){return this._curPayment?this._curPayment.getUserId():""}guestLogin(){return this._curPayment?this._curPayment.guestLogin():Promise.reject({code:"payHelper guestLogin fail",message:"this _curPayment is null"})}userLogin(e,t){return this._curPayment?this._curPayment.userLogin(e,t):Promise.reject({code:"payHelper userLogin fail",message:"this _curPayment is null"})}checkLoginAsync(){return this._curPayment?this._curPayment.checkLoginAsync():Promise.reject({code:"checkLoginAsync fail",message:"no payment selected"})}}.instance,O={currentCtx:null,show(){const e=document.createElement("div");e.setAttribute("style","position: absolute;z-index:1;width:100%;height:100%"),e.innerHTML='    \n      <div style="position: absolute;  left: 0;    top: 0;  bottom: 0;  right: 0;  margin: auto;  width: 289px;  height: 289px;   background: #FFFFFF; box-shadow: 0px 2px 7px 0px rgba(143, 143, 143, 0.48);  border-radius: 11px;    display: flex;flex-direction: column;align-items: center;justify-content: center;   ">\n          <div id="registerCloseBtn" style="position: absolute;right: 10px;top: 10px;">\n              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n                  <path style="fill: #4398FE "\n                      d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z">\n                  </path>\n                  <path fill="none" d="M0 0h24v24H0V0z"></path>\n              </svg>\n          </div>\n          <div id="registerError" style="position: absolute;right: 37px;top: 139px;font-size: 6px;font-weight: 400;color: #FB4242;"></div>\n          <div style="width: 202px;height: 17px;font-size: 15px;font-family: Microsoft YaHei;font-weight: bold;color: #010101;">Login with Phone Number</div>\n          <div style="margin-top:15px;width: 218px;height: 30px;border: 1px solid #BABABA;border-radius: 6px;display: flex;flex-direction: row;align-items: center;justify-content: center;"><div style="    width: 46px;border-right: 1px solid #CECECE ;"><select style="border: none;outline: none;" name="registerAreacode" id="registerAreacode">\n              <option value="91">+91</option>\n              <option value="1">+1</option>\n          </select></div><div style="flex: 1;"><input style="font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #515151;;background-color:transparent;border:0;width:90%;outline:none;margin-left: 6px;"\n              type="text" id="registerPhone" name="registerPhone" required placeholder="Please fill in the phone"></div></div>\n          <div id="registerSendBtn" style="margin-top:12px;font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFFFF;width: 218px;height: 35px;background: #4398FE;border-radius: 6px;display: flex;flex-direction: column;align-items: center;justify-content: center;">Send</div>                    \n          <div id="registerSendText" style="display: none;;text-align: center;margin-top:11px;font-size: 10px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFFFF;width: 218px;height: 35px;background: #BABABA;border-radius: 6px;    padding-top: 3px;box-sizing: border-box;">Wait tor <span id="registerTime">60</span> s <br>To Request Another Code</div>\n          <div style="margin-top:15px;width: 218px;height: 30px;border: 1px solid #BABABA;border-radius: 6px;display: flex;flex-direction: column;align-items: center;justify-content: center;"><input style="font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #515151;;background-color:transparent;border:0;width:90%;outline:none" type="text" id="registerVfcode" name="registerVfcode" required placeholder="Verification Code"> </div>\n          <div id="registerLoginBtn" style="margin-top:12px;font-size: 12px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFFFF;width: 218px;height: 35px;background: #4398FE;border-radius: 6px;display: flex;flex-direction: column;align-items: center;justify-content: center;">Login</div>\n          <div style="margin-top: 15px;    text-align: center;width: 210px;height: 17px;font-size: 8px;font-family: Microsoft YaHei;font-weight: 400;color: #010101;">By proceeding, you agree to our <span><a href="" target="_blank" style="color: #4398FE;" > Terms & Conditions</a></span>& <span><a href="" target="_blank" style="color: #4398FE;">Privacy Policy.</a></span></div>\n      </div>',w.createDailogContainer().append(e),this.currentCtx=e,e&&(this.initRegisterUi([91,86]),w.addCallbackEvent([{ele:e.querySelector("#registerCloseBtn"),eventName:"click",eventFunc:()=>{this.hide()}},{ele:e.querySelector("#registerSendBtn"),eventName:"click",eventFunc:()=>t(this,void 0,void 0,function*(){e.querySelector("#registerSendBtn")&&(e.querySelector("#registerSendBtn").style.display="none"),e.querySelector("#registerSendText")&&(e.querySelector("#registerSendText").style.display="block"),this.countdownFunc(60);try{var t=`${document.getElementById("registerAreacode")&&document.getElementById("registerAreacode").value||""}${document.getElementById("registerPhone")&&document.getElementById("registerPhone").value||""}`;yield C.sendVerifyCode(t),console.info("sendVerifyCode success")}catch(t){console.error("sendVerifyCode error",t)}})},{ele:e.querySelector("#registerLoginBtn"),eventName:"click",eventFunc:()=>t(this,void 0,void 0,function*(){var t=e.querySelector("#registerAreacode")&&e.querySelector("#registerAreacode").value||"",s=e.querySelector("#registerPhone")&&e.querySelector("#registerPhone").value||"",n=e.querySelector("#registerVfcode")&&e.querySelector("#registerVfcode").value||"";if(10===s.length&&/^\d{1,}$/.test(s))if(0!==n.length){var i;t=`${t}${s}`;try{j.init(),j.show(),yield E.userLogin(t,n),console.info("phoneLogin success"),Y.storageType===U.Local?(i=yield Y.checkNewUser(),Y.storageType=i?U.Cloud:U.Local,Y.userPhone=i?s:"",j.hide()):(j.hide(),Y.storageType=U.Cloud,Y.userPhone=s,N.success({message:"Login success",autoCloseTime:2,top:"50%",left:"50%"})),this.hide()}catch(t){console.error("phoneLogin error",t),j.hide(),this.hide(),M.showWithInit("OK","Login failed, please try again",()=>{O.show()})}}else this.displayErrorMessage("verification code error");else this.displayErrorMessage("phone number error")})},{ele:e.querySelector("#registerPhone"),eventName:"input",eventFunc:e=>{const t=e.target.value||"";/^\d+$/.test(t)?this.displayErrorMessage(""):(e.target.value=t.replace(/\D+/,""),this.displayErrorMessage("Please key in numbers!"))}}]))},hide(){w.removeDailogContainer(()=>{this.currentCtx&&this.currentCtx.remove()})},displayErrorMessage(e){const t=this.currentCtx.querySelector("#registerError");t&&(t.innerText=e)},addCallbackEvent(e){e&&0<e.length&&e.forEach(e=>{e.ele&&e.ele.addEventListener(e.eventName,t=>{e.eventFunc&&e.eventFunc(t)})})},countdownFunc(e){const t=this.currentCtx,s=t.querySelector("#registerTime");return function e(n){s.innerText=n,n--,setTimeout(()=>{0<(s.innerText=n)?e(n):(t.querySelector("#registerSendBtn")&&(t.querySelector("#registerSendBtn").style.display="flex"),t.querySelector("#registerSendText")&&(t.querySelector("#registerSendText").style.display="none"))},1e3)}(e)},initRegisterUi(e){const t=this.currentCtx.querySelector("#registerAreacode");e&&0<e.length&&t&&(t.innerHTML="",e.forEach(e=>{const s=document.createElement("option");s.setAttribute("value",`${e}`),s.innerText=`+${e}`,t.appendChild(s)}))}},j={currentCtx:null,btn:{name:"",func:()=>{j.hide()}},init(e){return this.btn.name="",this.btn.func=()=>{j.hide()},e&&(this.btn.name=e.btnName,this.btn.func=e.btnFunc),this.btn.hidden=!(0<this.btn.name.length),this},show(){var e=`\n      <div style="margin-top: -25px;top: 50%;width: 100%;text-align: center;position: absolute;display: flex;flex-direction: column;justify-content: center;align-items: center;">\n          <svg  t="1655447361916" style="animation: waitRotating 2s linear infinite;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3916" width="10" height="10"><path d="M768 576v-128h192v128h-192z m-120.32-290.24l136-135.68 90.24 90.24-135.68 136zM448 768h128v192h-128v-192z m0-704h128v192h-128V64zM150.08 783.68l135.68-136 90.56 90.56-136 135.68z m0-543.36l90.24-90.24 136 135.68-90.56 90.56zM256 576H64v-128h192v128z m617.92 207.68l-90.24 90.24-136-135.68 90.56-90.56z" fill="#409EFF" p-id="3917"></path></svg>\n          <p style="color: #409EFF;margin: 3px 0;font-size: 14px;">Loading...</p>\n          ${this.btn.name?`<div id="css_wait_ctx_cancel" style="margin-top: 25px;width: 130px;text-align: center;background: #fff;height: 30px;line-height: 30px;border-radius: 30px;">${this.btn.name}</div>`:""}\n      </div>\n      `;const t=document.createElement("div");t.setAttribute("style","position: absolute;z-index:10;width:100%;height:100%;transition: opacity .3s;background-color: rgb(0, 0, 0,0.6);"),t.innerHTML=e;const s=document.createElement("style");s.id="css_wait_style",s.type="text/css",s.innerHTML="\n    @keyframes waitRotating {\n        0% {\n        transform: rotateZ(0);\n        }\n        100% {\n            transform: rotateZ(360deg);\n        }\n    }\n    ",t.appendChild(s),w.createDailogContainer().append(t),this.currentCtx=t;const n=t.querySelector("#css_wait_ctx_cancel");n&&n.addEventListener("click",()=>{this.btn.func&&this.btn.func(),this.hide()})},hide(){w.removeDailogContainer(()=>{this.currentCtx&&this.currentCtx.remove()})}},N={success({autoCloseTime:e,message:t,top:s,left:n}){const i=e||1,r=s||"50%";n=n||"50%";const o=document.createElement("div");o.innerHTML=`<div style="transition: all 0.5s ease-out;border: 1px solid #e1f3d8;color:#67c23a;background: #f0f9eb;max-width: 300px;min-height: 20px;position: fixed;top: -100%;left:${n};transform: translate(-50%,-50%);z-index: 20001;border-radius: 4px;word-break: break-word;padding: 10px;">\n                <div>\n                    <svg t="1655970966078" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2181"\n                        width="20" height="20">\n                        <path\n                            d="M512 1024C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z m-114.176-310.954667a53.333333 53.333333 0 0 0 75.434667 0l323.328-323.328a53.333333 53.333333 0 1 0-75.434667-75.434666l-287.914667 283.306666-128.853333-128.853333a53.333333 53.333333 0 1 0-75.434667 75.434667l168.874667 168.874666z"\n                            fill="#67c23a" p-id="2182"></path>\n                    </svg>\n                </div>\n                <div>${t}</div>\n            </div>`,document.body.append(o),setTimeout(()=>{o.firstChild.style.top=r},500),setTimeout(()=>{var e=`${o.firstChild.getBoundingClientRect()&&o.firstChild.getBoundingClientRect().height/2||0}px`;o.firstChild.style.top=e,setTimeout(()=>{o.remove()},1e3*i)},1e3)},error({autoCloseTime:e,message:t,top:s,left:n}){e&&(this.autoCloseTime=e);const i=e||1,r=s||"50%";n=n||"50%";const o=document.createElement("div");o.innerHTML=`<div  style="transition: all 0.5s ease-out;border: 1px solid #fde2e2;color:#f56c6c;background: #fef0f0;max-width: 300px;min-height: 20px;position: fixed;top: -100%;left:${n};transform: translate(-50%,-50%);z-index: 20001;border-radius: 4px;word-break: break-word;padding: 10px;">\n                <div>\n                    <svg t="1655971895182" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3456" width="20" height="20"><path d="M827.392 195.584q65.536 65.536 97.792 147.456t32.256 167.936-32.256 167.936-97.792 147.456-147.456 98.304-167.936 32.768-168.448-32.768-147.968-98.304-98.304-147.456-32.768-167.936 32.768-167.936 98.304-147.456 147.968-97.792 168.448-32.256 167.936 32.256 147.456 97.792zM720.896 715.776q21.504-21.504 18.944-49.152t-24.064-49.152l-107.52-107.52 107.52-107.52q21.504-21.504 24.064-49.152t-18.944-49.152-51.712-21.504-51.712 21.504l-107.52 106.496-104.448-104.448q-21.504-20.48-49.152-23.04t-49.152 17.92q-21.504 21.504-21.504 52.224t21.504 52.224l104.448 104.448-104.448 104.448q-21.504 21.504-21.504 51.712t21.504 51.712 49.152 18.944 49.152-24.064l104.448-104.448 107.52 107.52q21.504 21.504 51.712 21.504t51.712-21.504z" p-id="3457" fill="#f56c6c"></path></svg>\n                </div>\n                <div>${t}</div>\n            </div>`,document.body.append(o),setTimeout(()=>{o.firstChild.style.top=r},500),setTimeout(()=>{var e=`${o.firstChild.getBoundingClientRect()&&o.firstChild.getBoundingClientRect().height/2||0}px`;o.firstChild.style.top=e,setTimeout(()=>{o.remove()},1e3*i)},1e3)}},M={message:"Sorry,This account already exists,\nplease change a new account.\r\n\r\nIf you want switch account,\nplease click the button.",currentCtx:null,btn:{name:"OK",func:()=>{}},init(e){return this.message="",this.btn.name="",this.btn.func=()=>{},e&&(this.message=e.message,this.btn.name=e.btnName,this.btn.func=e.btnFunc),this},show(){var e=`    \n    <div style="position: absolute;top: 50%;left: 50%;transform: translate(-50%,-50%);width: 278px;  min-height: 210px;   background: #FFFFFF; box-shadow: 0px 2px 7px 0px rgba(143, 143, 143, 0.48);  border-radius: 11px;    display: flex;flex-direction: column;align-items: center;">\n        <div style="margin: 20px 0 0px;display: flex;flex-direction: column;justify-content: center;align-items: center;"><div style="width:50px;height:50px;border-radius:50px;    background: url(/images/weiyou.png);background-position: center;background-repeat: no-repeat;background-size: contain;"></div>\n        <div style="max-width:268px;padding: 10px 0;min-height: 80px;width: 100%;overflow: hidden;text-align: center;word-break: break-word;box-sizing: border-box;line-height: 20px;white-space: pre-wrap;word-break: break-word;">${this.message}</div>                \n        <div id="confirmMessage" style=" margin-bottom: 20px;display: flex; justify-content: center; align-items: center;width: 230px; height: 35px; border-radius: 6px;background: #4398FE;  font-size: 13px;font-family: Microsoft YaHei;font-weight: 400;color: #FFFF" >${this.btn.name}</div>\n    </div>`;const t=document.createElement("div");t.setAttribute("style","position: absolute;z-index:1;width:100%;height:100%"),t.innerHTML=e,w.createDailogContainer().append(t),this.currentCtx=t,t&&w.addCallbackEvent([{ele:t.querySelector("#minigameDailogContainer #confirmMessage"),eventName:"click",eventFunc:()=>{this.removeUi(),this.btn.func&&this.btn.func instanceof Function&&this.btn.func()}}])},showWithInit(e,t,s){const n={};n.btnName=e,n.message=t,n.btnFunc=s,this.init(n),this.show()},removeUi(){w.removeDailogContainer(()=>{this.currentCtx&&this.currentCtx.remove()})}};var q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function F(e,t){return e(t={exports:{}},t.exports),t.exports}var U,$,L,H,z,W=F(function(t){t.exports=t=function(t){var s;if(!(s=!(s=!(s="undefined"!=typeof window&&window.crypto?window.crypto:s)&&"undefined"!=typeof window&&window.msCrypto?window.msCrypto:s)&&void 0!==q&&q.crypto?q.crypto:s))try{s=e}catch(r){}var n=Object.create||function(e){return i.prototype=e,e=new i,i.prototype=null,e};function i(){}var r={},o=r.lib={},a=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=o.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,s=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var r=0;r<i;r++){var o=s[r>>>2]>>>24-r%4*8&255;t[n+r>>>2]|=o<<24-(n+r)%4*8}else for(r=0;r<i;r+=4)t[n+r>>>2]=s[r>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,s=this.sigBytes;e[s>>>2]&=4294967295<<32-s%4*8,e.length=t.ceil(s/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(function(){if(s){if("function"==typeof s.getRandomValues)try{return s.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof s.randomBytes)try{return s.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")}());return new c.init(t,e)}}),d=r.enc={},l=d.Hex={stringify:function(e){for(var t=e.words,s=e.sigBytes,n=[],i=0;i<s;i++){var r=t[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,s=[],n=0;n<t;n+=2)s[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new c.init(s,t/2)}},h=d.Latin1={stringify:function(e){for(var t=e.words,s=e.sigBytes,n=[],i=0;i<s;i++){var r=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(r))}return n.join("")},parse:function(e){for(var t=e.length,s=[],n=0;n<t;n++)s[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new c.init(s,t)}},u=d.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},m=o.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var s,n=this._data,i=n.words,r=n.sigBytes,o=this.blockSize,a=r/(4*o),d=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o;if(r=t.min(4*d,r),d){for(var l=0;l<d;l+=o)this._doProcessBlock(i,l);s=i.splice(0,d),n.sigBytes-=r}return new c.init(s,r)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(o.Hasher=m.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,s){return new e.init(s).finalize(t)}},_createHmacHelper:function(e){return function(t,s){return new p.HMAC.init(e,s).finalize(t)}}}),r.algo={});return r}(Math)}),G=(F(function(e){var t;e.exports=(t=W,function(){var e,s=(e=t).lib,n=s.Base,i=s.WordArray;(e=e.x64={}).Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),e.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,s=[],n=0;n<t;n++){var r=e[n];s.push(r.high),s.push(r.low)}return i.create(s,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),s=t.length,i=0;i<s;i++)t[i]=t[i].clone();return e}})}(),t)}),F(function(e){var t;e.exports=(t=W,function(){var e,s;"function"==typeof ArrayBuffer&&(e=t.lib.WordArray,s=e.init,(e.init=function(e){if((e=(e=e instanceof ArrayBuffer?new Uint8Array(e):e)instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e)instanceof Uint8Array){for(var t=e.byteLength,n=[],i=0;i<t;i++)n[i>>>2]|=e[i]<<24-i%4*8;s.call(this,n,t)}else s.apply(this,arguments)}).prototype=e)}(),t.lib.WordArray)}),F(function(e){var t;e.exports=(t=W,function(){var e=t.lib.WordArray,s=t.enc;function n(e){return e<<8&4278255360|e>>>8&16711935}s.Utf16=s.Utf16BE={stringify:function(e){for(var t=e.words,s=e.sigBytes,n=[],i=0;i<s;i+=2){var r=t[i>>>2]>>>16-i%4*8&65535;n.push(String.fromCharCode(r))}return n.join("")},parse:function(t){for(var s=t.length,n=[],i=0;i<s;i++)n[i>>>1]|=t.charCodeAt(i)<<16-i%2*16;return e.create(n,2*s)}},s.Utf16LE={stringify:function(e){for(var t=e.words,s=e.sigBytes,i=[],r=0;r<s;r+=2){var o=n(t[r>>>2]>>>16-r%4*8&65535);i.push(String.fromCharCode(o))}return i.join("")},parse:function(t){for(var s=t.length,i=[],r=0;r<s;r++)i[r>>>1]|=n(t.charCodeAt(r)<<16-r%2*16);return e.create(i,2*s)}}}(),t.enc.Utf16)}),F(function(e){var t;e.exports=(t=W,function(){var e=t.lib.WordArray;t.enc.Base64={stringify:function(e){var t=e.words,s=e.sigBytes,n=this._map;e.clamp();for(var i=[],r=0;r<s;r+=3)for(var o=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,a=0;a<4&&r+.75*a<s;a++)i.push(n.charAt(o>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(t){var s=t.length,n=this._map;if(!(i=this._reverseMap))for(var i=this._reverseMap=[],r=0;r<n.length;r++)i[n.charCodeAt(r)]=r;var o=n.charAt(64);return!o||-1!==(o=t.indexOf(o))&&(s=o),function(t,s,n){for(var i=[],r=0,o=0;o<s;o++){var a,c;o%4&&(a=n[t.charCodeAt(o-1)]<<o%4*2,c=n[t.charCodeAt(o)]>>>6-o%4*2,c|=a,i[r>>>2]|=c<<24-r%4*8,r++)}return e.create(i,r)}(t,s,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),t.enc.Base64)}),F(function(e){var t;e.exports=(t=W,function(e){var s=t,n=(r=s.lib).WordArray,i=r.Hasher,r=s.algo,o=[];function a(e,t,s,n,i,r,o){return((o=e+(t&s|~t&n)+i+o)<<r|o>>>32-r)+t}function c(e,t,s,n,i,r,o){return((o=e+(t&n|s&~n)+i+o)<<r|o>>>32-r)+t}function d(e,t,s,n,i,r,o){return((o=e+(t^s^n)+i+o)<<r|o>>>32-r)+t}function l(e,t,s,n,i,r,o){return((o=e+(s^(t|~n))+i+o)<<r|o>>>32-r)+t}!function(){for(var t=0;t<64;t++)o[t]=4294967296*e.abs(e.sin(t+1))|0}(),r=r.MD5=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var n=t+s,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var r=this._hash.words,h=e[t+0],u=e[t+1],m=e[t+2],p=e[t+3],g=e[t+4],y=e[t+5],f=e[t+6],w=e[t+7],A=e[t+8],v=e[t+9],_=e[t+10],b=e[t+11],S=e[t+12],P=e[t+13],x=e[t+14],I=e[t+15],k=a(k=r[0],R=r[1],C=r[2],T=r[3],h,7,o[0]),T=a(T,k,R,C,u,12,o[1]),C=a(C,T,k,R,m,17,o[2]),R=a(R,C,T,k,p,22,o[3]);k=a(k,R,C,T,g,7,o[4]),T=a(T,k,R,C,y,12,o[5]),C=a(C,T,k,R,f,17,o[6]),R=a(R,C,T,k,w,22,o[7]),k=a(k,R,C,T,A,7,o[8]),T=a(T,k,R,C,v,12,o[9]),C=a(C,T,k,R,_,17,o[10]),R=a(R,C,T,k,b,22,o[11]),k=a(k,R,C,T,S,7,o[12]),T=a(T,k,R,C,P,12,o[13]),C=a(C,T,k,R,x,17,o[14]),k=c(k,R=a(R,C,T,k,I,22,o[15]),C,T,u,5,o[16]),T=c(T,k,R,C,f,9,o[17]),C=c(C,T,k,R,b,14,o[18]),R=c(R,C,T,k,h,20,o[19]),k=c(k,R,C,T,y,5,o[20]),T=c(T,k,R,C,_,9,o[21]),C=c(C,T,k,R,I,14,o[22]),R=c(R,C,T,k,g,20,o[23]),k=c(k,R,C,T,v,5,o[24]),T=c(T,k,R,C,x,9,o[25]),C=c(C,T,k,R,p,14,o[26]),R=c(R,C,T,k,A,20,o[27]),k=c(k,R,C,T,P,5,o[28]),T=c(T,k,R,C,m,9,o[29]),C=c(C,T,k,R,w,14,o[30]),k=d(k,R=c(R,C,T,k,S,20,o[31]),C,T,y,4,o[32]),T=d(T,k,R,C,A,11,o[33]),C=d(C,T,k,R,b,16,o[34]),R=d(R,C,T,k,x,23,o[35]),k=d(k,R,C,T,u,4,o[36]),T=d(T,k,R,C,g,11,o[37]),C=d(C,T,k,R,w,16,o[38]),R=d(R,C,T,k,_,23,o[39]),k=d(k,R,C,T,P,4,o[40]),T=d(T,k,R,C,h,11,o[41]),C=d(C,T,k,R,p,16,o[42]),R=d(R,C,T,k,f,23,o[43]),k=d(k,R,C,T,v,4,o[44]),T=d(T,k,R,C,S,11,o[45]),C=d(C,T,k,R,I,16,o[46]),k=l(k,R=d(R,C,T,k,m,23,o[47]),C,T,h,6,o[48]),T=l(T,k,R,C,w,10,o[49]),C=l(C,T,k,R,x,15,o[50]),R=l(R,C,T,k,y,21,o[51]),k=l(k,R,C,T,S,6,o[52]),T=l(T,k,R,C,p,10,o[53]),C=l(C,T,k,R,_,15,o[54]),R=l(R,C,T,k,u,21,o[55]),k=l(k,R,C,T,A,6,o[56]),T=l(T,k,R,C,I,10,o[57]),C=l(C,T,k,R,f,15,o[58]),R=l(R,C,T,k,P,21,o[59]),k=l(k,R,C,T,g,6,o[60]),T=l(T,k,R,C,b,10,o[61]),C=l(C,T,k,R,m,15,o[62]),R=l(R,C,T,k,v,21,o[63]),r[0]=r[0]+k|0,r[1]=r[1]+R|0,r[2]=r[2]+C|0,r[3]=r[3]+T|0},_doFinalize:function(){var t=this._data,s=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;s[i>>>5]|=128<<24-i%32;var r=e.floor(n/4294967296);n=n,s[15+(64+i>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),s[14+(64+i>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(s.length+1),this._process();for(var o=(s=this._hash).words,a=0;a<4;a++){var c=o[a];o[a]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),s.MD5=i._createHelper(r),s.HmacMD5=i._createHmacHelper(r)}(Math),t.MD5)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=(i=e.lib).WordArray,n=i.Hasher,i=e.algo,r=[];i=i.SHA1=n.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=this._hash.words,n=s[0],i=s[1],o=s[2],a=s[3],c=s[4],d=0;d<80;d++){d<16?r[d]=0|e[t+d]:(l=r[d-3]^r[d-8]^r[d-14]^r[d-16],r[d]=l<<1|l>>>31);var l=(n<<5|n>>>27)+c+r[d];l+=d<20?1518500249+(i&o|~i&a):d<40?1859775393+(i^o^a):d<60?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,c=a,a=o,o=i<<30|i>>>2,i=n,n=l}s[0]=s[0]+n|0,s[1]=s[1]+i|0,s[2]=s[2]+o|0,s[3]=s[3]+a|0,s[4]=s[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(64+n>>>9<<4)]=Math.floor(s/4294967296),t[15+(64+n>>>9<<4)]=s,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),e.SHA1=n._createHelper(i),e.HmacSHA1=n._createHmacHelper(i)}(),t.SHA1)}),F(function(e){var t;e.exports=(t=W,function(e){var s=t,n=(r=s.lib).WordArray,i=r.Hasher,r=s.algo,o=[],a=[];!function(){function t(e){return 4294967296*(e-(0|e))|0}for(var s=2,n=0;n<64;)!function(t){for(var s=e.sqrt(t),n=2;n<=s;n++)if(!(t%n))return;return 1}(s)||(n<8&&(o[n]=t(e.pow(s,.5))),a[n]=t(e.pow(s,1/3)),n++),s++}();var c=[];r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(e,t){for(var s=this._hash.words,n=s[0],i=s[1],r=s[2],o=s[3],d=s[4],l=s[5],h=s[6],u=s[7],m=0;m<64;m++){m<16?c[m]=0|e[t+m]:(p=c[m-15],g=c[m-2],c[m]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+c[m-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+c[m-16]);var p=n&i^n&r^i&r,g=u+((d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25))+(d&l^~d&h)+a[m]+c[m];u=h,h=l,l=d,d=o+g|0,o=r,r=i,i=n,n=g+(((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+p)|0}s[0]=s[0]+n|0,s[1]=s[1]+i|0,s[2]=s[2]+r|0,s[3]=s[3]+o|0,s[4]=s[4]+d|0,s[5]=s[5]+l|0,s[6]=s[6]+h|0,s[7]=s[7]+u|0},_doFinalize:function(){var t=this._data,s=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return s[i>>>5]|=128<<24-i%32,s[14+(64+i>>>9<<4)]=e.floor(n/4294967296),s[15+(64+i>>>9<<4)]=n,t.sigBytes=4*s.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),s.SHA256=i._createHelper(r),s.HmacSHA256=i._createHmacHelper(r)}(Math),t.SHA256)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=e.lib.WordArray,n=(i=e.algo).SHA256,i=i.SHA224=n.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=n._createHelper(i),e.HmacSHA224=n._createHmacHelper(i)}(),t.SHA224)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=e.lib.Hasher,n=(r=e.x64).Word,i=r.WordArray,r=e.algo;function o(){return n.create.apply(n,arguments)}var a=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=o()}(),r=r.SHA512=s.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var s,n=(s=this._hash.words)[0],i=s[1],r=s[2],o=s[3],d=s[4],l=s[5],h=s[6],u=s[7],m=n.high,p=n.low,g=i.high,y=i.low,f=r.high,w=r.low,A=o.high,v=o.low,_=d.high,b=d.low,S=l.high,P=l.low,x=h.high,I=h.low,k=u.high,T=m,C=p,R=g,B=y,D=f,E=w,O=A,j=v,N=_,M=b,q=S,F=P,U=x,$=I,L=k,H=s=u.low,z=0;z<80;z++){var W,G,K=c[z];z<16?(G=K.high=0|e[t+2*z],W=K.low=0|e[t+2*z+1]):(ee=(V=c[z-15]).high,te=V.low,X=(Q=c[z-2]).high,J=Q.low,Y=(Z=c[z-7]).high,V=Z.low,Z=(Q=c[z-16]).high,G=(G=((ee>>>1|te<<31)^(ee>>>8|te<<24)^ee>>>7)+Y+((W=(Y=(te>>>1|ee<<31)^(te>>>8|ee<<24)^(te>>>7|ee<<25))+V)>>>0<Y>>>0?1:0))+((X>>>19|J<<13)^(X<<3|J>>>29)^X>>>6)+((W+=te=(J>>>19|X<<13)^(J<<3|X>>>29)^(J>>>6|X<<26))>>>0<te>>>0?1:0),W+=ee=Q.low,K.high=G=G+Z+(W>>>0<ee>>>0?1:0),K.low=W);var V=N&q^~N&U,Y=M&F^~M&$,J=T&R^T&D^R&D,X=(C>>>28|T<<4)^(C<<30|T>>>2)^(C<<25|T>>>7),Q=(te=a[z]).high,Z=te.low,ee=H+((M>>>14|N<<18)^(M>>>18|N<<14)^(M<<23|N>>>9)),te=(K=L+((N>>>14|M<<18)^(N>>>18|M<<14)^(N<<23|M>>>9))+(ee>>>0<H>>>0?1:0),X+(C&B^C&E^B&E));L=U,H=$,U=q,$=F,q=N,F=M,N=O+(K=(K=(K=K+V+((ee+=Y)>>>0<Y>>>0?1:0))+Q+((ee+=Z)>>>0<Z>>>0?1:0))+G+((ee+=W)>>>0<W>>>0?1:0))+((M=j+ee|0)>>>0<j>>>0?1:0)|0,O=D,j=E,D=R,E=B,R=T,B=C,T=K+(((T>>>28|C<<4)^(T<<30|C>>>2)^(T<<25|C>>>7))+J+(te>>>0<X>>>0?1:0))+((C=ee+te|0)>>>0<ee>>>0?1:0)|0}p=n.low=p+C,n.high=m+T+(p>>>0<C>>>0?1:0),y=i.low=y+B,i.high=g+R+(y>>>0<B>>>0?1:0),w=r.low=w+E,r.high=f+D+(w>>>0<E>>>0?1:0),v=o.low=v+j,o.high=A+O+(v>>>0<j>>>0?1:0),b=d.low=b+M,d.high=_+N+(b>>>0<M>>>0?1:0),P=l.low=P+F,l.high=S+q+(P>>>0<F>>>0?1:0),I=h.low=I+$,h.high=x+U+(I>>>0<$>>>0?1:0),s=u.low=s+H,u.high=k+L+(s>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(128+n>>>10<<5)]=Math.floor(s/4294967296),t[31+(128+n>>>10<<5)]=s,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),e.SHA512=s._createHelper(r),e.HmacSHA512=s._createHmacHelper(r)}(),t.SHA512)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=(r=e.x64).Word,n=r.WordArray,i=(r=e.algo).SHA512,r=r.SHA384=i.extend({_doReset:function(){this._hash=new n.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=i._createHelper(r),e.HmacSHA384=i._createHmacHelper(r)}(),t.SHA384)}),F(function(e){var t;e.exports=(t=W,function(e){var s=t,n=(o=s.lib).WordArray,i=o.Hasher,r=s.x64.Word,o=s.algo,a=[],c=[],d=[];!function(){for(var e=1,t=0,s=0;s<24;s++){a[e+5*t]=(s+1)*(s+2)/2%64;var n=(2*e+3*t)%5;e=t%5,t=n}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,o=0;o<24;o++){for(var l,h=0,u=0,m=0;m<7;m++)1&i&&((l=(1<<m)-1)<32?u^=1<<l:h^=1<<l-32),128&i?i=i<<1^113:i<<=1;d[o]=r.create(h,u)}}();var l=[];!function(){for(var e=0;e<25;e++)l[e]=r.create()}(),o=o.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new r.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var s=this._state,n=this.blockSize/2,i=0;i<n;i++){var r=e[t+2*i],o=e[t+2*i+1];r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),(I=s[i]).high^=o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),I.low^=r}for(var h=0;h<24;h++){for(var u=0;u<5;u++){for(var m=0,p=0,g=0;g<5;g++)m^=(I=s[u+5*g]).high,p^=I.low;var y=l[u];y.high=m,y.low=p}for(u=0;u<5;u++){var f=l[(u+4)%5],w=(A=l[(u+1)%5]).high,A=A.low;for(m=f.high^(w<<1|A>>>31),p=f.low^(A<<1|w>>>31),g=0;g<5;g++)(I=s[u+5*g]).high^=m,I.low^=p}for(var v=1;v<25;v++){var _=(I=s[v]).high,b=I.low,S=a[v];p=S<32?(m=_<<S|b>>>32-S,b<<S|_>>>32-S):(m=b<<S-32|_>>>64-S,_<<S-32|b>>>64-S),(S=l[c[v]]).high=m,S.low=p}var P=l[0],x=s[0];for(P.high=x.high,P.low=x.low,u=0;u<5;u++)for(g=0;g<5;g++){var I=s[v=u+5*g],k=l[v],T=l[(u+1)%5+5*g],C=l[(u+2)%5+5*g];I.high=k.high^~T.high&C.high,I.low=k.low^~T.low&C.low}I=s[0],x=d[h],I.high^=x.high,I.low^=x.low}},_doFinalize:function(){var t=this._data,s=t.words,i=(this._nDataBytes,8*t.sigBytes),r=32*this.blockSize;s[i>>>5]|=1<<24-i%32,s[(e.ceil((1+i)/r)*r>>>5)-1]|=128,t.sigBytes=4*s.length,this._process();for(var o=this._state,a=(s=this.cfg.outputLength/8)/8,c=[],d=0;d<a;d++){var l=(h=o[d]).high,h=h.low;l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),c.push(h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)),c.push(l)}return new n.init(c,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),s=0;s<25;s++)t[s]=t[s].clone();return e}}),s.SHA3=i._createHelper(o),s.HmacSHA3=i._createHmacHelper(o)}(Math),t.SHA3)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=(i=e.lib).WordArray,n=i.Hasher,i=e.algo,r=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),a=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=s.create([0,1518500249,1859775393,2400959708,2840853838]),l=s.create([1352829926,1548603684,1836072691,2053994217,0]);function h(e,t,s){return e&t|~e&s}function u(e,t,s){return e&s|t&~s}function m(e,t){return e<<t|e>>>32-t}i=i.RIPEMD160=n.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var n=t+s,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var p,g,y,f,w,A,v=this._hash.words,_=d.words,b=l.words,S=r.words,P=o.words,x=a.words,I=c.words,k=p=v[0],T=g=v[1],C=y=v[2],R=f=v[3],B=w=v[4];for(s=0;s<80;s+=1)A=p+e[t+S[s]]|0,A+=s<16?(g^y^f)+_[0]:s<32?h(g,y,f)+_[1]:s<48?((g|~y)^f)+_[2]:s<64?u(g,y,f)+_[3]:(g^(y|~f))+_[4],A=(A=m(A|=0,x[s]))+w|0,p=w,w=f,f=m(y,10),y=g,g=A,A=k+e[t+P[s]]|0,A+=s<16?(T^(C|~R))+b[0]:s<32?u(T,C,R)+b[1]:s<48?((T|~C)^R)+b[2]:s<64?h(T,C,R)+b[3]:(T^C^R)+b[4],A=(A=m(A|=0,I[s]))+B|0,k=B,B=R,R=m(C,10),C=T,T=A;A=v[1]+y+R|0,v[1]=v[2]+f+B|0,v[2]=v[3]+w+k|0,v[3]=v[4]+p+T|0,v[4]=v[0]+g+C|0,v[0]=A},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(64+n>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=(t=this._hash).words,r=0;r<5;r++){var o=i[r];i[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}return t},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),e.RIPEMD160=n._createHelper(i),e.HmacRIPEMD160=n._createHmacHelper(i)}(Math),t.RIPEMD160)}),F(function(e){var t;e.exports=(t=W,void function(){var e=t.lib.Base,s=t.enc.Utf8;t.algo.HMAC=e.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var n=e.blockSize,i=4*n;(t=t.sigBytes>i?e.finalize(t):t).clamp(),e=this._oKey=t.clone(),t=this._iKey=t.clone();for(var r=e.words,o=t.words,a=0;a<n;a++)r[a]^=1549556828,o[a]^=909522486;e.sigBytes=t.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}())}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=(r=e.lib).Base,n=r.WordArray,i=e.algo,r=i.SHA1,o=i.HMAC,a=i.PBKDF2=s.extend({cfg:s.extend({keySize:4,hasher:r,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s=this.cfg,i=o.create(s.hasher,e),r=n.create(),a=n.create([1]),c=r.words,d=a.words,l=s.keySize,h=s.iterations;c.length<l;){var u=i.update(t).finalize(a);i.reset();for(var m=u.words,p=m.length,g=u,y=1;y<h;y++){g=i.finalize(g),i.reset();for(var f=g.words,w=0;w<p;w++)m[w]^=f[w]}r.concat(u),d[0]++}return r.sigBytes=4*l,r}});e.PBKDF2=function(e,t,s){return a.create(s).compute(e,t)}}(),t.PBKDF2)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=(r=e.lib).Base,n=r.WordArray,i=e.algo,r=i.MD5,o=i.EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:r,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s,i=this.cfg,r=i.hasher.create(),o=n.create(),a=o.words,c=i.keySize,d=i.iterations;a.length<c;){s&&r.update(s),s=r.update(e).finalize(t),r.reset();for(var l=1;l<d;l++)s=r.finalize(s),r.reset();o.concat(s)}return o.sigBytes=4*c,o}});e.EvpKDF=function(e,t,s){return o.create(s).compute(e,t)}}(),t.EvpKDF)}),F(function(e){var t;e.exports=void((t=W).lib.Cipher||function(){var e=(p=t).lib,s=e.Base,n=e.WordArray,i=e.BufferedBlockAlgorithm,r=((l=p.enc).Utf8,l.Base64),o=p.algo.EvpKDF,a=e.Cipher=i.extend({cfg:s.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,s){this.cfg=this.cfg.extend(s),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,s,n){return c(s).encrypt(e,t,s,n)},decrypt:function(t,s,n){return c(s).decrypt(e,t,s,n)}}}});function c(e){return"string"==typeof e?g:m}e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var d=p.mode={},l=e.BlockCipherMode=s.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}});function h(e,t,s){var n,i=this._iv;i?(n=i,this._iv=void 0):n=this._prevBlock;for(var r=0;r<s;r++)e[t+r]^=n[r]}l=d.CBC=((d=l.extend()).Encryptor=d.extend({processBlock:function(e,t){var s=this._cipher,n=s.blockSize;h.call(this,e,t,n),s.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}),d.Decryptor=d.extend({processBlock:function(e,t){var s=this._cipher,n=s.blockSize,i=e.slice(t,t+n);s.decryptBlock(e,t),h.call(this,e,t,n),this._prevBlock=i}}),d),d=(p.pad={}).Pkcs7={pad:function(e,t){for(var s=(t*=4)-e.sigBytes%t,i=s<<24|s<<16|s<<8|s,r=[],o=0;o<s;o+=4)r.push(i);t=n.create(r,s),e.concat(t)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};var u=(e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:l,padding:d}),reset:function(){var e;a.reset.call(this);var t=(s=this.cfg).iv,s=s.mode;this._xformMode==this._ENC_XFORM_MODE?e=s.createEncryptor:(e=s.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,t&&t.words):(this._mode=e.call(s,this,t&&t.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),e.CipherParams=s.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),m=(d=(p.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return(t=(e=e.salt)?n.create([1398893684,1701076831]).concat(e).concat(t):t).toString(r)},parse:function(e){var t,s=r.parse(e);return 1398893684==(e=s.words)[0]&&1701076831==e[1]&&(t=n.create(e.slice(2,4)),e.splice(0,4),s.sigBytes-=16),u.create({ciphertext:s,salt:t})}},e.SerializableCipher=s.extend({cfg:s.extend({format:d}),encrypt:function(e,t,s,n){n=this.cfg.extend(n),t=(i=e.createEncryptor(s,n)).finalize(t);var i=i.cfg;return u.create({ciphertext:t,key:s,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,s,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(s,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),p=(p.kdf={}).OpenSSL={execute:function(e,t,s,i){return i=i||n.random(8),e=o.create({keySize:t+s}).compute(e,i),s=n.create(e.words.slice(t),4*s),e.sigBytes=4*t,u.create({key:e,iv:s,salt:i})}},g=e.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:p}),encrypt:function(e,t,s,n){return s=(n=this.cfg.extend(n)).kdf.execute(s,e.keySize,e.ivSize),n.iv=s.iv,(n=m.encrypt.call(this,e,t,s.key,n)).mixIn(s),n},decrypt:function(e,t,s,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),s=n.kdf.execute(s,e.keySize,e.ivSize,t.salt),n.iv=s.iv,m.decrypt.call(this,e,t,s.key,n)}})}())}),F(function(e){var t;e.exports=((t=W).mode.CFB=function(){var e=t.lib.BlockCipherMode.extend();function s(e,t,s,n){var i,r=this._iv;r?(i=r.slice(0),this._iv=void 0):i=this._prevBlock,n.encryptBlock(i,0);for(var o=0;o<s;o++)e[t+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize;s.call(this,e,t,i,n),this._prevBlock=e.slice(t,t+i)}}),e.Decryptor=e.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=e.slice(t,t+i);s.call(this,e,t,i,n),this._prevBlock=r}}),e}(),t.mode.CFB)}),F(function(e){var t;e.exports=((t=W).mode.CTR=function(){var e=t.lib.BlockCipherMode.extend(),s=e.Encryptor=e.extend({processBlock:function(e,t){var s=this._cipher,n=s.blockSize,i=this._iv,r=this._counter;i&&(r=this._counter=i.slice(0),this._iv=void 0);var o=r.slice(0);s.encryptBlock(o,0),r[n-1]=r[n-1]+1|0;for(var a=0;a<n;a++)e[t+a]^=o[a]}});return e.Decryptor=s,e}(),t.mode.CTR)}),F(function(e){var t;e.exports=((t=W).mode.CTRGladman=function(){var e=t.lib.BlockCipherMode.extend();function s(e){var t,s,n;return 255==(e>>24&255)?(s=e>>8&255,n=255&e,255==(t=e>>16&255)?(t=0,255===s?(s=0,255===n?n=0:++n):++s):++t,e=0,e+=t<<16,e+=s<<8,e+=n):e+=1<<24,e}var n=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=this._iv,o=this._counter;r&&(o=this._counter=r.slice(0),this._iv=void 0),0===((r=o)[0]=s(r[0]))&&(r[1]=s(r[1]));var a=o.slice(0);n.encryptBlock(a,0);for(var c=0;c<i;c++)e[t+c]^=a[c]}});return e.Decryptor=n,e}(),t.mode.CTRGladman)}),F(function(e){var t;e.exports=((t=W).mode.OFB=function(){var e=t.lib.BlockCipherMode.extend(),s=e.Encryptor=e.extend({processBlock:function(e,t){var s=this._cipher,n=s.blockSize,i=this._iv,r=this._keystream;i&&(r=this._keystream=i.slice(0),this._iv=void 0),s.encryptBlock(r,0);for(var o=0;o<n;o++)e[t+o]^=r[o]}});return e.Decryptor=s,e}(),t.mode.OFB)}),F(function(e){var t;e.exports=((t=W).mode.ECB=function(){var e=t.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),t.mode.ECB)}),F(function(e){e.exports=((e=W).pad.AnsiX923={pad:function(e,t){var s=(s=e.sigBytes)+(t=(t*=4)-s%t)-1;e.clamp(),e.words[s>>>2]|=t<<24-s%4*8,e.sigBytes+=t},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923)}),F(function(e){var t;e.exports=((t=W).pad.Iso10126={pad:function(e,s){s*=4,s-=e.sigBytes%s,e.concat(t.lib.WordArray.random(s-1)).concat(t.lib.WordArray.create([s<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},t.pad.Iso10126)}),F(function(e){var t;e.exports=((t=W).pad.Iso97971={pad:function(e,s){e.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(e,s)},unpad:function(e){t.pad.ZeroPadding.unpad(e),e.sigBytes--}},t.pad.Iso97971)}),F(function(e){e.exports=((e=W).pad.ZeroPadding={pad:function(e,t){t*=4,e.clamp(),e.sigBytes+=t-(e.sigBytes%t||t)},unpad:function(e){var t=e.words,s=e.sigBytes-1;for(s=e.sigBytes-1;0<=s;s--)if(t[s>>>2]>>>24-s%4*8&255){e.sigBytes=s+1;break}}},e.pad.ZeroPadding)}),F(function(e){e.exports=((e=W).pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding)}),F(function(e){var t;e.exports=(t=W,function(){var e=t.lib.CipherParams,s=t.enc.Hex;t.format.Hex={stringify:function(e){return e.ciphertext.toString(s)},parse:function(t){return t=s.parse(t),e.create({ciphertext:t})}}}(),t.format.Hex)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=e.lib.BlockCipher,n=e.algo,i=[],r=[],o=[],a=[],c=[],d=[],l=[],h=[],u=[],m=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var s=0,n=0;for(t=0;t<256;t++){var p=n^n<<1^n<<2^n<<3^n<<4;i[s]=p=p>>>8^255&p^99;var g=e[r[p]=s],y=e[g],f=e[y],w=257*e[p]^16843008*p;o[s]=w<<24|w>>>8,a[s]=w<<16|w>>>16,c[s]=w<<8|w>>>24,d[s]=w,l[p]=(w=16843009*f^65537*y^257*g^16843008*s)<<24|w>>>8,h[p]=w<<16|w>>>16,u[p]=w<<8|w>>>24,m[p]=w,s?(s=g^e[e[e[f^g]]],n^=e[e[n]]):s=n=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=s.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,s=e.sigBytes/4,n=4*(1+(this._nRounds=6+s)),r=this._keySchedule=[],o=0;o<n;o++)o<s?r[o]=t[o]:(d=r[o-1],o%s?6<s&&o%s==4&&(d=i[d>>>24]<<24|i[d>>>16&255]<<16|i[d>>>8&255]<<8|i[255&d]):(d=i[(d=d<<8|d>>>24)>>>24]<<24|i[d>>>16&255]<<16|i[d>>>8&255]<<8|i[255&d],d^=p[o/s|0]<<24),r[o]=r[o-s]^d);for(var a=this._invKeySchedule=[],c=0;c<n;c++){var d;o=n-c,d=c%4?r[o]:r[o-4],a[c]=c<4||o<=4?d:l[i[d>>>24]]^h[i[d>>>16&255]]^u[i[d>>>8&255]]^m[i[255&d]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,a,c,d,i)},decryptBlock:function(e,t){var s=e[t+1];e[t+1]=e[t+3],e[t+3]=s,this._doCryptBlock(e,t,this._invKeySchedule,l,h,u,m,r),s=e[t+1],e[t+1]=e[t+3],e[t+3]=s},_doCryptBlock:function(e,t,s,n,i,r,o,a){for(var c=this._nRounds,d=e[t]^s[0],l=e[t+1]^s[1],h=e[t+2]^s[2],u=e[t+3]^s[3],m=4,p=1;p<c;p++){var g=n[d>>>24]^i[l>>>16&255]^r[h>>>8&255]^o[255&u]^s[m++],y=n[l>>>24]^i[h>>>16&255]^r[u>>>8&255]^o[255&d]^s[m++],f=n[h>>>24]^i[u>>>16&255]^r[d>>>8&255]^o[255&l]^s[m++],w=n[u>>>24]^i[d>>>16&255]^r[l>>>8&255]^o[255&h]^s[m++];d=g,l=y,h=f,u=w}g=(a[d>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&u])^s[m++],y=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[u>>>8&255]<<8|a[255&d])^s[m++],f=(a[h>>>24]<<24|a[u>>>16&255]<<16|a[d>>>8&255]<<8|a[255&l])^s[m++],w=(a[u>>>24]<<24|a[d>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^s[m++],e[t]=g,e[t+1]=y,e[t+2]=f,e[t+3]=w},keySize:8}),e.AES=s._createHelper(n)}(),t.AES)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=(i=e.lib).WordArray,n=i.BlockCipher,i=e.algo,r=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],a=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],l=i.DES=n.extend({_doReset:function(){for(var e=this._key.words,t=[],s=0;s<56;s++){var n=r[s]-1;t[s]=e[n>>>5]>>>31-n%32&1}for(var i=this._subKeys=[],c=0;c<16;c++){var d=i[c]=[],l=a[c];for(s=0;s<24;s++)d[s/6|0]|=t[(o[s]-1+l)%28]<<31-s%6,d[4+(s/6|0)]|=t[28+(o[s+24]-1+l)%28]<<31-s%6;for(d[0]=d[0]<<1|d[0]>>>31,s=1;s<7;s++)d[s]=d[s]>>>4*(s-1)+3;d[7]=d[7]<<5|d[7]>>>27}var h=this._invSubKeys=[];for(s=0;s<16;s++)h[s]=i[15-s]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,s){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),u.call(this,2,858993459),u.call(this,8,16711935),h.call(this,1,1431655765);for(var n=0;n<16;n++){for(var i=s[n],r=this._lBlock,o=this._rBlock,a=0,l=0;l<8;l++)a|=c[l][((o^i[l])&d[l])>>>0];this._lBlock=o,this._rBlock=r^a}var m=this._lBlock;this._lBlock=this._rBlock,this._rBlock=m,h.call(this,1,1431655765),u.call(this,8,16711935),u.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){t=(this._lBlock>>>e^this._rBlock)&t,this._rBlock^=t,this._lBlock^=t<<e}function u(e,t){t=(this._rBlock>>>e^this._lBlock)&t,this._lBlock^=t,this._rBlock^=t<<e}e.DES=n._createHelper(l),i=i.TripleDES=n.extend({_doReset:function(){if(2!==(n=this._key.words).length&&4!==n.length&&n.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var e=n.slice(0,2),t=n.length<4?n.slice(0,2):n.slice(2,4),n=n.length<6?n.slice(0,2):n.slice(4,6);this._des1=l.createEncryptor(s.create(e)),this._des2=l.createEncryptor(s.create(t)),this._des3=l.createEncryptor(s.create(n))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2}),e.TripleDES=n._createHelper(i)}(),t.TripleDES)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=e.lib.StreamCipher,n=e.algo,i=n.RC4=s.extend({_doReset:function(){for(var e=this._key,t=e.words,s=e.sigBytes,n=this._S=[],i=0;i<256;i++)n[i]=i;i=0;for(var r=0;i<256;i++){var o=t[(o=i%s)>>>2]>>>24-o%4*8&255;r=(r+n[i]+o)%256,o=n[i],n[i]=n[r],n[r]=o}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=r.call(this)},keySize:8,ivSize:0});function r(){for(var e=this._S,t=this._i,s=this._j,n=0,i=0;i<4;i++){s=(s+e[t=(t+1)%256])%256;var r=e[t];e[t]=e[s],e[s]=r,n|=e[(e[t]+e[s])%256]<<24-8*i}return this._i=t,this._j=s,n}e.RC4=s._createHelper(i),n=n.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;0<e;e--)r.call(this)}}),e.RC4Drop=s._createHelper(n)}(),t.RC4)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=e.lib.StreamCipher,n=e.algo,i=[],r=[],o=[];function a(){for(var e=this._X,t=this._C,s=0;s<8;s++)r[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,s=0;s<8;s++){var n=e[s]+t[s],i=65535&n,a=n>>>16;o[s]=((i*i>>>17)+i*a>>>15)+a*a^((4294901760&n)*n|0)+((65535&n)*n|0)}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}n=n.Rabbit=s.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,s=0;s<4;s++)e[s]=16711935&(e[s]<<8|e[s]>>>24)|4278255360&(e[s]<<24|e[s]>>>8);var n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(s=this._b=0;s<4;s++)a.call(this);for(s=0;s<8;s++)i[s]^=n[s+4&7];if(t){var r,o=(t=16711935&((o=(r=t.words)[0])<<8|o>>>24)|4278255360&(o<<24|o>>>8))>>>16|4294901760&(r=16711935&((c=r[1])<<8|c>>>24)|4278255360&(c<<24|c>>>8)),c=r<<16|65535&t;for(i[0]^=t,i[1]^=o,i[2]^=r,i[3]^=c,i[4]^=t,i[5]^=o,i[6]^=r,i[7]^=c,s=0;s<4;s++)a.call(this)}},_doProcessBlock:function(e,t){var s=this._X;a.call(this),i[0]=s[0]^s[5]>>>16^s[3]<<16,i[1]=s[2]^s[7]>>>16^s[5]<<16,i[2]=s[4]^s[1]>>>16^s[7]<<16,i[3]=s[6]^s[3]>>>16^s[1]<<16;for(var n=0;n<4;n++)i[n]=16711935&(i[n]<<8|i[n]>>>24)|4278255360&(i[n]<<24|i[n]>>>8),e[t+n]^=i[n]},blockSize:4,ivSize:2}),e.Rabbit=s._createHelper(n)}(),t.Rabbit)}),F(function(e){var t;e.exports=(t=W,function(){var e=t,s=e.lib.StreamCipher,n=e.algo,i=[],r=[],o=[];function a(){for(var e=this._X,t=this._C,s=0;s<8;s++)r[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,s=0;s<8;s++){var n=e[s]+t[s],i=65535&n,a=n>>>16;o[s]=((i*i>>>17)+i*a>>>15)+a*a^((4294901760&n)*n|0)+((65535&n)*n|0)}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}n=n.RabbitLegacy=s.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,s=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]],i=this._b=0;i<4;i++)a.call(this);for(i=0;i<8;i++)n[i]^=s[i+4&7];if(t){var r,o=(t=16711935&((o=(r=t.words)[0])<<8|o>>>24)|4278255360&(o<<24|o>>>8))>>>16|4294901760&(r=16711935&((e=r[1])<<8|e>>>24)|4278255360&(e<<24|e>>>8));for(e=r<<16|65535&t,n[0]^=t,n[1]^=o,n[2]^=r,n[3]^=e,n[4]^=t,n[5]^=o,n[6]^=r,n[7]^=e,i=0;i<4;i++)a.call(this)}},_doProcessBlock:function(e,t){var s=this._X;a.call(this),i[0]=s[0]^s[5]>>>16^s[3]<<16,i[1]=s[2]^s[7]>>>16^s[5]<<16,i[2]=s[4]^s[1]>>>16^s[7]<<16,i[3]=s[6]^s[3]>>>16^s[1]<<16;for(var n=0;n<4;n++)i[n]=16711935&(i[n]<<8|i[n]>>>24)|4278255360&(i[n]<<24|i[n]>>>8),e[t+n]^=i[n]},blockSize:4,ivSize:2}),e.RabbitLegacy=s._createHelper(n)}(),t.RabbitLegacy)}),F(function(e){e.exports=W}));const K=class e{constructor(){this.handleUrl=e=>t=>{if(t){const s=[];Object.keys(t).forEach(e=>s.push("keys="+t[e])),-1===e.search(/\?/)?"object"==typeof t&&(e+="?"+s.join("&")):e+="&"+s.join("&")}return e}}static get instance(){return this._instance||(this._instance=new e),this._instance}getDataAsync(e){return t(this,void 0,void 0,function*(){console.info("====> getData userId: ",E.getUserId()),""===E.getUserId()&&console.error("=====> userId is null");var t=o.get,s=`${f.channelName}_${f.channel}_${f.gameId}_${E.getUserId()}`;console.info("get data id: ",s);var n=(new Date).toUTCString().toString();const i=G.enc.Base64,r=G.HmacSHA512;let a=`/${x.GET_DATA}/${s}?`,c=`${x.PAY_IP}/dev/${x.GET_DATA}/${s}?`;e.forEach((e,t)=>{0!==t&&(c+="&",a+="&"),c+=`keys=${e}`,a+=`keys=${e}`}),s=i.stringify(r(`(request-target): get ${a}\nx-date: ${n}\ndigest: `,"HMACSHA512-SecretKey"));const d=new Headers;return d.append("Authorization",`Signature keyId="write",algorithm="hmac-sha512",headers="(request-target) x-date digest",signature="${s}"`),d.append("x-date",n),t={method:t,headers:d,redirect:"follow"},yield fetch(c,t).then(e=>e.ok?e.json():Promise.reject({code:e.status,message:`get ${c} fail status: ${e.status}`})).then(e=>(console.info(`get ${c} success response: ${JSON.stringify(e)}`),Promise.resolve(e.data))).catch(e=>(console.error(`get ${c} error: ${e.message}`),Promise.reject({code:"CloudStorage getData error",message:e.message})))})}setDataAsync(e){return t(this,void 0,void 0,function*(){""===E.getUserId()&&console.error("=====> userId is null");var t=o.post,s=(new Date).toUTCString().toString();const n=G.SHA256,i=G.enc.Base64,r=G.HmacSHA512;var a=`${f.channelName}_${f.channel}_${f.gameId}_${E.getUserId()}`;console.info("set data id: ",a);var c={id:a,data:e},d=`SHA-256=${i.stringify(n(JSON.stringify(c)))}`;a=i.stringify(r(`(request-target): post /${x.SET_DATA}\nx-date: ${s}\ndigest: ${d}`,"HMACSHA512-SecretKey"));const l=new Headers;l.append("Authorization",`Signature keyId="write",algorithm="hmac-sha512",headers="(request-target) x-date digest",signature="${a}"`),l.append("Content-Type","application/json"),l.append("x-date",s),l.append("digest",d),t={method:t,headers:l,body:JSON.stringify(c)};const h=`${x.PAY_IP}/dev/${x.SET_DATA}`;return console.info("=====> cloudStorage setData: ",JSON.stringify(c)),yield fetch(h,t).then(e=>e.ok?e.json():Promise.reject({code:e.status,message:`post ${h} fail status: ${e.status}`})).then(e=>(console.info(`post ${h} success response: ${JSON.stringify(e)}`),Promise.resolve())).catch(e=>(console.error("CloudStorage setData error: "+e.message),Promise.reject({message:"CloudStorage setData error: "+e.message})))})}}.instance,V=class e{static get instance(){return this._instance||(this._instance=new e),this._instance}init(){}getDataAsync(e){if(!e||0===e.length)return Promise.reject({message:"LocalStorage getData keys null"});const t={};for(const s of e)t[s]=m(s);return console.info("======> get local data: ",t),Promise.resolve(t)}setDataAsync(e){if(!e)return Promise.reject({message:"LocalStorage setData data null"});for(const t in e)p(t,e[t]);return g(),console.info("======> set local data: ",e),Promise.resolve()}}.instance;(pt=U=U||{}).Local="Local",pt.Cloud="Cloud",pt.None="None",(Gt=$=$||{}).GuestUid="guestUid",Gt.UserPhone="userPhone",Gt.StorageType="storageType";const Y=class e{constructor(){this._storageType=U.None,this._guestUid="",this._userPhone=""}static get instance(){return this._instance||(this._instance=new e),this._instance}init(){V.init()}set storageType(e){this._storageType=e,p($.StorageType,this._storageType),g()}get storageType(){return m($.StorageType)&&(this._storageType=m($.StorageType)),this._storageType}set guestUid(e){this._guestUid=e,p($.GuestUid,this._guestUid),g()}get guestUid(){return m($.GuestUid)&&(this._guestUid=m($.GuestUid)),this._guestUid}set userPhone(e){this._userPhone=e,p($.UserPhone,this._userPhone),g()}get userPhone(){return m($.UserPhone)&&(this._userPhone=m($.UserPhone)),this._userPhone}isNewUser(){return t(this,void 0,void 0,function*(){try{var e=h,t=Object.keys(e),s=yield K.getDataAsync(t),n=!s;return console.info(`====> check keys: ${t}/\n getData: ${s}\n !!getData: ${n}`),Promise.resolve(n)}catch(e){return console.error(`isNewUser error: ${e.message}`),Promise.reject({code:"isNewUser error",message:e.message})}})}checkNewUser(){return t(this,void 0,void 0,function*(){try{var e=yield this.isNewUser();return e?yield this.dealBindingAccountSuccess():this.dealExistAccountBinding(),Promise.resolve(e)}catch(e){return console.error(`checkNewUser error: ${e.message}`),Promise.reject({code:"checkNewUser error",message:`${e.message}`})}})}dealExistAccountBinding(){const e={btnName:"SWITCH",message:"Sorry,This account already exists,\nplease change a new account.\n\nIf you want switch account,\nplease click the button.",btnFunc:()=>{O.show()}};M.init(e),M.show()}dealBindingAccountSuccess(){return t(this,void 0,void 0,function*(){try{return yield K.setDataAsync(h),N.success({message:"Register success.",autoCloseTime:2,top:"50%",left:"50%"}),Promise.resolve()}catch(F){return N.success({message:"Register fail.",autoCloseTime:2,top:"50%",left:"50%"}),Promise.reject({code:"fail save local data to cloud",message:F.message})}})}getDataAsync(e){return(this._storageType===U.Cloud?K:V).getDataAsync(e)}setDataAsync(e){return(this._storageType===U.Cloud?K:V).setDataAsync(e)}}.instance;class J{getASID(){return""}getSignature(){return""}}class X{constructor(e,t=""){this._id=e,this._name=t}static get currentPlayer(){if(!this._currentPlayer){!function(e=""){if(!u&&(u=!0,null!==e&&(l+=e),null!=(e=localStorage.getItem(l))))try{var t=JSON.parse(e);h=t}catch(t){console.error("Failed to parse local data: "+e)}}();let e=m(this.PLAYER_KEY,"");""===e&&(e=i.generateId(),p(this.PLAYER_KEY,e),g()),X._currentPlayer=new X(e)}return this._currentPlayer}getID(){return this._id}getSignedPlayerInfoAsync(e){return i.emptyWaitUnsupportApi("FBPlayer.getSignedPlayerInfoAsync")}canSubscribeBotAsync(){return i.emptyWaitBool(!1)}subscribeBotAsync(){return i.emptyWaitUnsupportApi("FBPlayer.subscribeBotAsync")}getName(){return this._name}getPhoto(){return""}getDataAsync(e){if(window.MiniGameAds&&window.MiniGameAds.isTest){const t={};for(const s of e)t[s]=m(s);return i.emptyWaitObject(t)}return console.info("=======> get data with keys: ",e),Y.getDataAsync(e)}setDataAsync(e){if(console.info("=======> set data: ",e),window.MiniGameAds&&window.MiniGameAds.isTest){for(const t in e)p(t,e[t]);return g(),i.emptyWaitObject(null)}return Y.setDataAsync(e)}flushDataAsync(){return g(),i.emptyWaitObject(null)}getStatsAsync(e){return this.getDataAsync(e)}setStatsAsync(e){return this.setDataAsync(e)}incrementStatsAsync(e){let t=!1;const s={};for(const i in e){if("number"!=typeof e[i]){t=!0;break}var n=m(i,0)+1;p(i,n),s[i]=n}var r=t?{code:-1,msg:"error! one or more data type not number!"}:s;return t||g(),i.emptyWaitObject(r)}getConnectedPlayersAsync(){return i.emptyWaitObject([])}getASIDAsync(){return i.emptyWaitObject(this.getID())}getSignedASIDAsync(){var e=new J;return i.emptyWaitObject(e)}}function Q(e,t,s){let i,r;return void 0===t&&(t=0),void 0===s&&(s=50),new Promise(function(o,a){const c=function(){e()?(r&&clearTimeout(r),o()):i=setTimeout(c,s)};i=setTimeout(c,s),0<t&&(r=setTimeout(()=>{i&&clearTimeout(i),a(n.TIMEOUT)},t))})}X.PLAYER_KEY="_minigame_player_id_";const Z={preroll:"preroll",start:"start",pause:"pause",next:"next",browse:"browse",reward:"reward"},ee={notReady:"notReady",timeout:"timeout",error:"error",noAdPreloaded:"noAdPreloaded",frequencyCapped:"frequencyCapped",ignored:"ignored",other:"other",dismissed:"dismissed",viewed:"viewed"};let te=!1,se=0;const ne=5;function ie(){return se<=0?0:se+ne-Date.now()}function re(e){return e===ee.viewed||e===ee.dismissed}function oe(e){let t="UNKNOWN_ERROR",s=t;return e&&(e.breakStatus&&(t=e.breakStatus),s=`${e.breakFormat}:${e.breakType}:${e.breakName} error, status: ${e.breakStatus}`),ae(t,s)}function ae(e,t){return{code:e,message:t}}function ce(e){return e===Z.preroll}function de(e){return e===Z.reward}let le=!1;function he(){if(!le){le=!0,console.info("===> checking Ads");try{adConfig({onReady:()=>{console.info("===> Ads are ready"),te=!0,le=!1}})}catch(F){console.debug("===> Check Ready, got error: ",F),console.info("===> Assume Ads ready"),te=!0,le=!1}}}function ue(e,t,s){return null!=s&&s.onShow(),console.info("===> showAdSenseAsync called: ",e,t),de(e),new Promise((n,i)=>{if(!ce(e)){if(!te)return void i(ae("notLoaded","ad not loaded"));if(!(ie()<=0))return void i(ae("notReady","ad not ready, wait: "+(ie()/1e3).toFixed(2)+" seconds"))}const r={type:e,name:t,adBreakDone:r=>{console.info("===> showAdSense:adBreakDone, type: "+e+", name: "+t,r),re(r.breakStatus)?(se=Date.now(),null!=s&&s.onClose(),te=!1,setTimeout(()=>{he()},100)):null!=s&&s.onFail(),de(e)?r.breakStatus===ee.viewed?n():i(oe(r)):re(r.breakStatus)?(null!=s&&s.onSuccess(),n()):(i(oe(r)),null!=s&&s.onFail())}};ce(e)||(r.beforeAd=()=>{console.info("===> showAdSense:beforeAd, type: "+e+", name: "+t)},r.afterAd=()=>{console.info("===> showAdSense:afterAd, type: "+e+", name: "+t)}),de(e)&&(r.beforeReward=n=>{console.info("===> showAdSense:beforeReward, type: "+e+", name: "+t),n(),null!=s&&s.onSuccess()},r.adDismissed=()=>{console.info("===> showAdSense:adDismissed, type: "+e+", name: "+t),null!=s&&s.onFail()},r.adViewed=()=>{console.info("===> showAdSense:adViewed, type: "+e+", name: "+t)}),console.info("===> showAdSense:tryShow, type: "+e+", name: "+t),adBreak(r)})}class me{constructor(){this._runningAsyncTask=null,this._queues=[],this._isProcessingTaskUUID=0,this._enable=!0,this.complete=null}get queues(){return this._queues}get enable(){return this._enable}set enable(e){this._enable!==e&&(this._enable=e)&&0<this.size&&this.play()}push(e,t=null){var s=me._$uuid_count++;return this._queues.push({uuid:s,callbacks:[e],params:t}),s}pushMulti(e,...t){var s=me._$uuid_count++;return this._queues.push({uuid:s,callbacks:t,params:e}),s}remove(e){var t;if((null===(t=this._runningAsyncTask)||void 0===t?void 0:t.uuid)!==e){for(let s=0;s<this._queues.length;s++)if(this._queues[s].uuid===e){this._queues.splice(s,1);break}}else console.warn("A running task cannot be removed")}get size(){return this._queues.length}get isProcessing(){return 0<this._isProcessingTaskUUID}get isStop(){return!(0<this._queues.length||this.isProcessing)}get runningParams(){return this._runningAsyncTask?this._runningAsyncTask.params:null}clear(){this._queues=[],this._isProcessingTaskUUID=0,this._runningAsyncTask=null}next(e,t=null){this._isProcessingTaskUUID===e?(this._isProcessingTaskUUID=0,this._runningAsyncTask=null,this.play(t)):this._runningAsyncTask&&console.info("====> runningAsyncTask: ",this._runningAsyncTask)}step(){this.isProcessing&&this.next(this._isProcessingTaskUUID)}play(e=null){if(!this.isProcessing&&this._enable){var t=this._queues.shift();if(t){const i=(this._runningAsyncTask=t).uuid;this._isProcessingTaskUUID=i;const r=t.callbacks;if(1===r.length)r[0]((e=null)=>{this.next(i,e)},t.params,e);else{let o=r.length;const a=[];var s=(e=null)=>{--o,a.push(e||null),0===o&&this.next(i,a)},n=o;for(let i=0;i<n;i++)r[i](s,t.params,e)}}else this._isProcessingTaskUUID=0,this._runningAsyncTask=null,this.complete&&this.complete(e)}}yieldTime(e,t=null){this.push(function(s,n,i){const r=setTimeout(()=>{clearTimeout(r),t&&t(),s(i)},e)},{des:"AsyncQueue.yieldTime"})}static excuteTimes(e,t=null){let s=e;return()=>{0==--s&&t&&t()}}}me._$uuid_count=1,(Ft=L=L||{}).PREROLL="preroll",Ft.INTERSTITIAL="interstitial",Ft.REWARDED="reward",Ft.BANNER="banner";class pe{constructor(e,t,s,n){this._strategyName="AdsStrategy",this._placementId=e,this._isRewarded=t,this._isOpened=!0,this._type=this._isRewarded?L.REWARDED:L.INTERSTITIAL,console.info("AdsStrategy constructor placementId: type: strategyName",e,this._type,this._strategyName)}getPlacementID(){return this._placementId}getType(){return this._type}setType(e){this._type=e}getRewardedType(){return this._isRewarded}setRewardedType(e){this._isRewarded=e}getIsOpened(){return this._isOpened}setIsOpened(e){this._isOpened=e}getStrategyName(){return this._strategyName}setAdsCallback(e){this._adsCallback=e}getAdsCallbackOption(){return this._adsCallback}}class ge extends pe{constructor(){super(...arguments),this._strategyName="AfgStrategy"}loadAsync(){return he(),Q(()=>te,1e3).then(()=>(console.info("[AFG] Ads loaded"),Promise.resolve())).catch(e=>(console.info("[AFG] Ads load error: ",e),Promise.reject(e)))}showAsync(){return t(this,void 0,void 0,function*(){var e=(t={isRewardedAd:this.getRewardedType(),placementId:this.getPlacementID(),uid:""}).isRewardedAd?Z.reward:Z.next,t=t.placementId;console.info(`===> show ad: ${e}|${t}`);try{return yield ue(e,t,this.getAdsCallbackOption()),console.info("[AFG] show ads: success"),Promise.resolve()}catch(t){return console.info("[AFG] show ads: error: ",t),Promise.reject(t)}})}isReady(){return te}}const ye={addCallbackEvent(e){e&&0<e.length&&e.forEach(e=>{e.ele&&e.ele.addEventListener(e.eventName,t=>{e.eventFunc&&e.eventFunc(t)})})},createDailogContainer(){let e=document.getElementById("minigameDailogContainer");return e||((e=document.createElement("div")).setAttribute("id","minigameDailogContainer"),e.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;top:0;  z-index: 20000; overflow: hidden; width: 100vw;height: 100vh; background-color: rgb(0, 0, 0,0.6);"),document.body.append(e)),e},removeDailogContainer(e){const t=document.getElementById("minigameDailogContainer");t&&t.childNodes&&t.childNodes.length<=1?t&&t.remove():e&&e instanceof Function&&e()}};class fe{constructor(e,t){this.currentContainerElement=null,this.currentContainerParentElement=null,this.currentSpecialContainerRootElement=null,this.ifCommonAd=!0,this.container=null,this.adProperties=null,this.adCloseCallback=null,this.adsCallBack=null,this.currentContainerElement=null,this.currentContainerParentElement=null,this.currentSpecialContainerRootElement=null,e&&e.containerObj&&(this.container=e.containerObj),e.adProperties?this.adProperties=e.adProperties:this.adProperties={},this.ifCommonAd=e.ifCommonAd,this.adsCallBack=t,this.loadScript()}showAd(e){return t(this,void 0,void 0,function*(){return new Promise((s,n)=>t(this,void 0,void 0,function*(){var t,i;try{null!==(t=this.adsCallBack)&&void 0!==t&&t.onShow(),this.ifCommonAd?yield this._addAdToContainer():yield this._addAdToSpecilContainer(e),null!==(i=this.adsCallBack)&&void 0!==i&&i.onSuccess(),this.adCloseCallback={},this.adCloseCallback.call=()=>{var e;s(),null!==(e=this.adsCallBack)&&void 0!==e&&e.onClose()}}catch(t){null!==(i=this.adsCallBack)&&void 0!==i&&i.onFail(),n({code:"show taboola ad error",message:t.message})}}))})}closeAd(){var e;return this.ifCommonAd&&this.currentContainerElement?(null!==(e=this.adCloseCallback)&&void 0!==e&&e.call(),this.currentContainerElement.remove(),Promise.resolve(!0)):!this.ifCommonAd&&this.currentSpecialContainerRootElement?(null!==(e=this.adCloseCallback)&&void 0!==e&&e.call(),this._removeSpecilContainer(),Promise.resolve(!0)):Promise.resolve(!1)}loadScript(){var e,t,s;fe.ifLoadScript||(window._taboola=window._taboola||[],_taboola.push({article:"auto"}),e=document.createElement("script"),t=document.getElementsByTagName("script")[0],s="tb_loader_script",document.getElementById(s)||(e.async=1,e.src="//cdn.taboola.com/libtrc/minigame-network/loader.js",e.id=s,t.parentNode.insertBefore(e,t)),window.performance&&"function"==typeof window.performance.mark&&window.performance.mark("tbl_ic"),fe.ifLoadScript=!0)}_setAttributesToElememt(e,t){if(e&&t)for(const n in e){var s;Object.hasOwnProperty.call(e,n)&&(s=e[n],t.setAttribute(n,s))}}_addAdToContainer(){try{const e=document.createElement("div");e.setAttribute("id",this.container.id),this.currentContainerElement=e,this._setAttributesToElememt(this.container.propertysObj,e);const t=document.querySelector(`${this.container.containerStr}`);if(t)if(this.currentContainerParentElement=t,this.container.ifInsertBefore){let s=null;t.hasChildNodes()&&(s=t.childNodes[0]),t.insertBefore(e,s)}else t.appendChild(e);return Promise.resolve(!0).then(e=>(this._setAd(),this._displayAd(),e))}catch(F){return console.error("show taboola ad is error",F),Promise.resolve(!1)}}_addAdToSpecilContainer(e){try{var t=`    \n        <div style="overflow: hidden;width: 100vw;height: 100vh;background-color: #262626;">\n            <div style="display: flex;justify-content: center;border: 1px solid transparent;border-radius: 4px;height: 8vh;background-color: #424242;line-height: 8vh;font-family: Google Sans, Roboto, Arial, sans-serif;font-size: 20px;color: #f5f5f5">\n                Ad\n                <div style="display: flex;position: absolute;right: 0;flex-direction: row;align-items: center;padding-right: 4%;height: inherit;cursor: pointer;">\n                    <div>\n                        <div id="closeAd" style="display: ${e.closeTime<0?"flex":"none"};align-items: center;">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n                                <path style="fill: #f5f5f5"\n                                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z">\n                                </path>\n                                <path fill="none" d="M0 0h24v24H0V0z"></path>\n                            </svg>\n                        </div>\n                        <div id="autoSkidAd" style="display:${0<=e.closeTime?"block":"none"}; font-size: 12px">\n                        Reward in <span id="autoSkidAdNum">${e.closeTime}</span> seconds\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div id="specilContainerTaboolaAd" style="display: flex;flex-direction: column;justify-content: center;align-items: center;width: 100vw;height: 92vh;">\n\n            </div>\n        </div>\n        `;const s=document.createElement("div");s.setAttribute("style","position: absolute;z-index:5;width:100%;height:100%"),s.innerHTML=t,ye.createDailogContainer().append(s),this.currentContainerParentElement=s.querySelector("#specilContainerTaboolaAd"),this.currentSpecialContainerRootElement=s;const n=document.createElement("div");n.setAttribute("id",this.container.id),this.currentContainerElement=n,this._setAttributesToElememt(this.container.propertysObj,n),this.currentContainerParentElement.appendChild(n);const i=s.querySelector("#closeAd"),r=s.querySelector("#autoSkidAd"),o=s.querySelector("#autoSkidAdNum");i.addEventListener("click",()=>{this.closeAd()});const a=t=>{o.innerText=t,t--,setTimeout(()=>{0<(o.innerText=t)?a(t):e.ifautoClose?this.closeAd():(i.style.display="flex",r.style.display="none")},1e3)};return a(e.closeTime),Promise.resolve(!0).then(e=>(this._setAd(),this._displayAd(),e))}catch(t){return console.error("show taboola ad is error",t),Promise.resolve(!1)}}_removeSpecilContainer(){ye.removeDailogContainer(()=>{this.currentSpecialContainerRootElement&&this.currentSpecialContainerRootElement.remove()})}_setAd(){window._taboola=window._taboola||[],window._taboola.push(Object.assign({target_type:"mix"},this.adProperties))}_displayAd(){window._taboola=window._taboola||[],window._taboola.push({flush:!0})}}fe.ifLoadScript=!1;class we extends fe{constructor(e){e.ifCommonAd=!0,super(e)}showAd(){return super.showAd()}closeAd(){return super.closeAd()}}class Ae extends fe{constructor(e,t){e.taboolaParam.ifCommonAd=!1,e.closeInfo.closeTime=-1,super(e.taboolaParam,t),this.closeProperties=null,this.closeProperties=e.closeInfo}showAd(){return super.showAd(this.closeProperties)}closeAd(){return super.closeAd().then(e=>(this.closeProperties.closeBackFunc&&this.closeProperties.closeBackFunc instanceof Function&&this.closeProperties.closeBackFunc(),e))}}class ve extends fe{constructor(e,t){e.taboolaParam.ifCommonAd=!1,super(e.taboolaParam,t),this.closeProperties=null,this.closeProperties=e.closeInfo}showAd(){return super.showAd(this.closeProperties)}closeAd(){return super.closeAd().then(e=>(this.closeProperties.closeBackFunc&&this.closeProperties.closeBackFunc instanceof Function&&this.closeProperties.closeBackFunc(),e))}}class _e extends pe{constructor(){super(...arguments),this._curAd=null,this._strategyName="TaboolaStrategy"}loadAsync(){try{const e={taboolaParam:{containerObj:{id:"taboola-mobile-below-article-thumnbnails_interstitial",propertysObj:{style:"width: 340px;height:450px;overflow: hidden;margin: auto;background: white;"}},adProperties:{mode:"thumbnails-a1",container:"taboola-mobile-below-article-thumnbnails_interstitial",placement:"Mobile below article thumnbnails_Interstitial"+(this.getRewardedType()?`_${window.channelName}.rewarded`:`_${window.channelName}.interstitial`)},ifCommonAd:!1},closeInfo:{closeTime:5,ifautoClose:!1,closeBackFunc:()=>{}}};return this.getRewardedType()?(e.closeInfo.closeBackFunc=()=>{console.info("TaboolaRewardAd close")},this._curAd=new ve(e,this.getAdsCallbackOption())):(e.closeInfo.closeBackFunc=()=>{console.info("TaboolaInterstitialAd close")},this._curAd=new Ae(e,this.getAdsCallbackOption())),Promise.resolve()}catch(F){return Promise.reject({code:`load ${this.getRewardedType()?"TaboolaRewardedVideoAd":"TaboolaInterstitialAd"} error`,message:F})}}showAsync(){return t(this,void 0,void 0,function*(){try{return yield this._curAd.showAd(),Promise.resolve()}catch(F){return Promise.reject({code:`show ${this.getRewardedType()?"TaboolaRewardedVideoAd":"TaboolaInterstitialAd"} error`,message:F})}})}isReady(){return!0}}class be extends pe{constructor(){super(...arguments),this._strategyName="AndroidStrategy",this._showAdsResult=null}loadAsync(){return new Promise(e=>{e()})}showAsync(){return new Promise((e,t)=>{if(window.AdInteractive){if(this.getRewardedType()){var s=window.AdInteractive.isRewardedVideoAdReady();if(console.info("isRewardReady: ",s),!s)return console.info("android show Reward ads fail by not ready"),void t({code:"android show fail",message:"android show Reward ads fail by not ready"});window.AdInteractive.showRewardedVideoAd()}else{if(!window.AdInteractive.isInterstitialAdReady())return void t({code:"android show fail",message:"android show Inters ads fail by not ready"});window.AdInteractive.showInterstitialAd()}this._showAdsResult=s=>{s?e():t({code:"android show fail",message:"android show ads fail"})}}else t("Android AdInteractive not exist")})}isReady(){return!0}onShowAdsResult(e,t){console.info("====> android call back show success: ",e),this._showAdsResult?this._showAdsResult(e,t):console.info("====> android show ads result error")}}class Se{constructor(e){this._isReward=!1,this._adInstants=[],this._curAdInstant=null,this._refreshTotalShowTimeCallback=null,this._isFinish=!1,this._isReward=e}get IsFinish(){return this._isFinish}set refreshTotalShowTimeCallback(e){this._refreshTotalShowTimeCallback=e}get refreshTotalShowTimeCallback(){return this._refreshTotalShowTimeCallback}getCurAdName(){return""}onShowAdsResult(e,t){var s;console.info(`onShowAdsResult: isSuccess: ${e}, errMessage: ${t}, this._curAdInstant: ${this._curAdInstant}`),this._curAdInstant&&null!==(s=this._curAdInstant)&&void 0!==s&&s.onShowAdsResult(e,t)}}(Ut=H=H||{})[Ut.AdTypeEnumNull=0]="AdTypeEnumNull",Ut[Ut.Display=1]="Display",Ut[Ut.Float=2]="Float",Ut[Ut.Banner=3]="Banner",Ut[Ut.Interstitial=4]="Interstitial",Ut[Ut.Rewarded=5]="Rewarded";class Pe{constructor(){this._mdaInfos=[]}static get instance(){return this._instance||(this._instance=new Pe),this._instance}fetchMdaData(e){return t(this,void 0,void 0,function*(){try{if(1<this._mdaInfos.length){var t=this._mdaInfos.shift();return Promise.resolve(t)}var s=yield S(`${k.DOMAIN}${k.BATCH_API_PATH}`,{batch:[{adType:e,count:3}]});if(console.info("====> MDA Info: ",s),200!==s.code)return Promise.reject({code:"REQUEST_MDA_ERROR",message:s.message});this._mdaInfos=this._mdaInfos.concat(s.data.ads);var n=this._mdaInfos.shift();return Promise.resolve(n)}catch(t){return Promise.reject({code:"FETCH_MDS_ERROR",message:t.message})}})}}Pe._instance=null;const xe=Pe.instance,Ie={interstitial:1,rewardedVideo:2,banner:3},ke={close:"close",adLoaded:"finish",adLoadError:"loadError",click:"click"};class Te{constructor(e,t,s){this.adid=e.id,this.adType=e.type,this.adTargetUrl=e.target_url,this.adMaterial=e.material_url,this.adTemplateUrl=e.template_url,this.adShowAttributeUrl=e.show_attribute_url,this.playLimitTime=e.impression,this.iframe=null,this.adTargetObj=null,this.isInit=!1,this.timeStamp=(new Date).getTime().toString(),this.gaId=t,this.cbOptions=s}getIframe(){return this.iframe}getGaId(){return this.gaId}getAdType(){return this.adType}getAdTargetUrl(){return this.adTargetUrl}getAdMaterial(){return this.adMaterial}getAdTemplateUrl(){return this.adTemplateUrl}getTimeStamp(){return this.timeStamp}getAdId(){return this.adid}getInit(){return this.isInit}getPlayLimitTime(){return this.playLimitTime}getShowAttributeUrl(){return this.adShowAttributeUrl}onShow(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onShow()}onSuccess(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onSuccess()}onFail(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onFail()}onClose(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onClose()}onClick(){var e;null!==(e=this.cbOptions)&&void 0!==e&&e.onClick()}createIframe(){return new Promise((e,t)=>{const s=window.document.createElement("iframe");s.setAttribute("style","overflow: hidden !important; width: 100vw !important; height: 100vh !important; top:0 !important; right:0 !important; bottom:0 !important; left:0 !important; position: fixed !important; clear: none !important; display: none !important; float: none !important; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1 !important; padding: 0px !important; vertical-align: baseline !important; visibility: visible !important; z-index: 1000000000 !important;"),s.setAttribute("src",this.adTemplateUrl),s.setAttribute("id","minigameiframe"),s.setAttribute("marginwidth","0"),s.setAttribute("frameborder","0"),s.setAttribute("marginheight","0"),s.setAttribute("scrolling","no"),window.document.querySelector("html").appendChild(s),s.onload=function(){console.info("iframe loaded"),e(s)},s.onerror=function(e){console.error("fail to load iframe: ",e),t(new Error(e.toString()))}})}showIframe(){this.iframe.setAttribute("style","overflow: hidden !important; width: 100vw !important; height: 100vh !important; top:0 !important; right:0 !important; bottom:0 !important; left:0 !important; position: fixed !important; clear: none !important; display: inline !important; float: none !important; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1 !important; padding: 0px !important; vertical-align: baseline !important; visibility: visible !important; z-index: 1000000000 !important;")}removeIframe(){this.isInit&&this.iframe.remove(),this.isInit=!1}initAsync(){return t(this,void 0,void 0,function*(){try{if(this.iframe=yield this.createIframe(),null===this.iframe)throw console.warn("fail to create iframe"),{code:"NO_IFRAME",msg:"fail to create iframe"};switch(this.adType){case Ie.interstitial:case Ie.rewardedVideo:this.adTargetObj=new Ce(this);break;case Ie.banner:throw{code:"NO_BANNER",msg:"feature is under development"}}var e={adTargetUrl:this.adTargetUrl,adMaterial:this.adMaterial,timeStamp:this.timeStamp,adId:this.adid,gaId:this.gaId,showAd:!1};return this.adTargetObj.loadAd(e,this.iframe),window.removeEventListener("message",this.receiveMessageFromIframePage.bind(this),!1),window.addEventListener("message",this.receiveMessageFromIframePage.bind(this),!1),this.isInit=!0,this.adTargetObj}catch(e){throw console.error("fail to init minigame ads: ",e),new Error(e.toString())}})}receiveMessageFromIframePage(e){if(e.data&&e.data.action&&this.timeStamp===e.data.timeStamp&&(console.info("receive message from iframe: ",e),this.isInit))switch(e.data.action){case ke.close:this.adTargetObj.closeAd(),this.onClose();break;case ke.adLoaded:this.adTargetObj.ready=!0;break;case ke.adLoadError:this.adTargetObj.ready=!1;break;case ke.click:this.onClick()}}}class Ce extends class{constructor(e){this.adCloseEvent=null,this.adLoadedEvent=null,this.adIframe=e}set ready(e){var t;this.isReady=e,null!==(t=this.adLoadedEvent)&&void 0!==t&&t.call(e)}get ready(){return this.isReady}loadAd(e,t){this.timeStamp=e.timeStamp,console.info("send message to iframe: ",e),t.contentWindow.postMessage(e,"*")}showAd(){return new Promise(()=>{let e=!1;return this.adIframe.getInit()&&(this.adIframe.showIframe(),e=!0),e})}closeAd(){let e=!1;return this.adIframe.getInit()&&(this.adIframe.removeIframe(),e=!0),e}getAdId(){return this.adIframe.getAdId()}getPlayLimitTime(){return this.adIframe.getPlayLimitTime()}}{constructor(e){super(e),this.ready=!1}showAd(){return new Promise((e,t)=>{try{this.adIframe.onShow(),this.adCloseEvent={},this.adCloseEvent.call=()=>{e()};const s={adTargetUrl:this.adIframe.getAdTargetUrl(),adShowAttributeUrl:this.adIframe.getShowAttributeUrl(),adMaterial:this.adIframe.getAdMaterial(),timeStamp:this.adIframe.getTimeStamp(),gaId:this.adIframe.getGaId(),adId:this.adIframe.getAdId(),adType:this.adIframe.getAdType(),showAd:!0};super.showAd()&&this.ready?(this.adIframe.getIframe().contentWindow.postMessage(s,"*"),this.adIframe.onSuccess()):(this.adLoadedEvent={},this.adLoadedEvent.call=e=>{e?(this.adIframe.getIframe().contentWindow.postMessage(s,"*"),this.adIframe.onSuccess()):(this.adIframe.onFail(),t({code:"not ready",msg:"fail to show ad due to not ready"}))})}catch(e){console.error(e),t({code:"not ready",msg:"fail to show ad due to not ready:"+e}),this.adIframe.onFail()}})}closeAd(){var e;let t=!1;try{super.closeAd()&&(t=!0,null!==(e=this.adCloseEvent)&&void 0!==e&&e.call())}catch(e){console.error(e)}return t}}window.createAdIframe=function(e,s,n){return t(this,void 0,void 0,function*(){try{const t=new Te(e,s,n);return yield t.initAsync()}catch(F){throw{code:"load_ad_error",message:"load ad error: "+F.message}}})};class Re extends pe{constructor(){super(...arguments),this._curAd=null,this._strategyName="MdaStrategy",this._isStartLoad=!1,this._isLoaded=!1,this._loadedCallback=null}loadAsync(){return t(this,void 0,void 0,function*(){try{const t=1,s=2;var e=yield xe.fetchMdaData(this.getRewardedType()?H.Rewarded:H.Interstitial);const n={};n.id=e.id,n.type=this.getRewardedType()?s:t,n.template_url=e.template_url,n.material_url=e.material.url,n.target_url=e.target_url,n.show_attribute_url=e.show_attribute_url,n.support_country=[],n.support_language=[],n.impression=0;const i=new Te(n,"",this.getAdsCallbackOption());return console.info("====> MDA start load"),this._isStartLoad=!0,this._curAd=yield i.initAsync(),this._isLoaded=!0,this._loadedCallback&&this._loadedCallback(this._isLoaded),console.info("====> MDA load success"),Promise.resolve()}catch(e){return console.info("====> MDA load error: ",e),Promise.reject({code:"MDA_LOAD_ERROR",message:e.message})}})}setEventCallback(){this.setAdsCallback({onShow:()=>{console.log(" =======> MDA show")},onSuccess:()=>{console.log(" =======> MDA success")},onFail:()=>{console.log(" =======> MDA failed")},onClick:()=>{console.log(" =======> MDA clicked")},onClose:()=>{console.log(" =======> MDA closed")}})}showAsync(){return t(this,void 0,void 0,function*(){if(!this._isLoaded&&this._isStartLoad)return new Promise((e,s)=>{this._loadedCallback=n=>t(this,void 0,void 0,function*(){n?this._curAd?(yield this._curAd.showAd(),console.info("====> MDA show success"),e()):s({code:"NO_ADS",message:"[MDA] no ads"}):s({code:"MDA_SHOW_ERROR",message:"MDA load fail"})})});try{return this._curAd?(yield this._curAd.showAd(),console.info("====> MDA show success"),Promise.resolve()):Promise.reject({code:"NO_ADS",message:"[MDA] no ads"})}catch(F){return console.info("====> MDA show error: ",F),Promise.reject({code:"MDA_SHOW_ERROR",message:F.message})}})}isReady(){return this._curAd&&this._curAd.ready}}class Be extends Se{constructor(e,t,s){super(e),this._config=null,this._next=null,this._curSucTimes=0,this._curAdName="",this._config=t,this._next=s}loadAsync(e){return t(this,void 0,void 0,function*(){try{if(this._curSucTimes<this._config.showTimes||-1===this._config.showTimes){const t={adsense:ge,taboola:_e,android:be,mda:Re}[this._config.adsName];if(void 0===t)return this._isFinish=!0,this._next&&this._next(),console.info(`======> error: ${this._config.adsName} waterfall strategy not found, exec queue next`),Promise.reject({code:I.ADS_NETWORK_NOT_FOUND,message:`${this._config.adsName} waterfall strategy not found`});const s=new t(e,this._isReward);return s.setAdsCallback({onShow:()=>{console.log(`====> ${this._curAdName} show`)},onSuccess:()=>{console.log(`====> ${this._curAdName} success`),this._curSucTimes++,this._curSucTimes===this._config.showTimes&&(this._isFinish=!0,this._next&&this._next()),this._refreshTotalShowTimeCallback&&this._refreshTotalShowTimeCallback()},onFail:()=>{console.log(`====> ${this._curAdName} failed`)},onClick:()=>{console.log(`====> ${this._curAdName} clicked`)},onClose:()=>{console.log(`====> ${this._curAdName} closed`)}}),yield s.loadAsync(),this._adInstants.push(s),Promise.resolve()}return Promise.reject({code:"load waterFall ad error",message:"has reach showTimes"})}catch(F){return Promise.reject({code:"load waterFall ad error",message:F.message})}})}showAsync(){return t(this,void 0,void 0,function*(){try{if(this._adInstants.length<=0)return Promise.reject({code:"show adInstant error",message:"there is no ad instant"});if(this._curSucTimes<this._config.showTimes||-1===this._config.showTimes){const e=this._adInstants.shift();return this._curAdName=e.getStrategyName(),this._curAdInstant=e,yield e.showAsync(),Promise.resolve()}}catch(F){return Promise.reject(F)}})}getCurAdName(){return this._curAdName=this._adInstants[0].getStrategyName(),this._curAdName}}class De extends Se{constructor(e,t){super(e),this.adsNames=[],this.curAdName="",this.adsNames=this.adsNames.concat(t)}loadAsync(e){return t(this,void 0,void 0,function*(){try{var t={adsense:ge,taboola:_e,android:be,mda:Re},s=Math.floor(Math.random()*this.adsNames.length);const i=t[this.adsNames[s]];var n={onShow:()=>{console.log(`====> ${this.curAdName} show`)},onSuccess:()=>{console.log(`====> ${this.curAdName} success`),this._refreshTotalShowTimeCallback&&this._refreshTotalShowTimeCallback()},onFail:()=>{console.log(`====> ${this.curAdName} failed`)},onClick:()=>{console.log(`====> ${this.curAdName} clicked`)},onClose:()=>{console.log(`====> ${this.curAdName} closed`)}};if(this._adInstants.length<=0){const t=new i(e,this._isReward);this._adInstants.push(t),t.setAdsCallback(n),yield t.loadAsync();const s=new i(e,this._isReward);this._adInstants.push(s),s.setAdsCallback(n),yield s.loadAsync()}else{const t=new i(e,this._isReward);this._adInstants.push(t),t.setAdsCallback(n),yield t.loadAsync()}return Promise.resolve()}catch(t){return Promise.reject({code:"load keep bottom ad error",message:t.message})}})}showAsync(){try{const e=this._adInstants.shift();return this.curAdName=e.getStrategyName(),this._curAdInstant=e,e.showAsync()}catch(F){return Promise.reject({code:"Keep_Bottom_ad_show_error",message:F.message})}}getCurAdName(){return this.curAdName=this._adInstants[0].getStrategyName(),this.curAdName}}class Ee extends Se{constructor(e,t){super(e),this.adsNames=[],this.adsNames=this.adsNames.concat(t)}loadAsync(e){return t(this,void 0,void 0,function*(){if(0===this.adsNames.length)return console.info("====> No Substitute Ads's config"),Promise.resolve();try{var t={adsense:ge,taboola:_e,android:be,mda:Re};const s={AfgStrategy:"adsense",TaboolaStrategy:"taboola",AndroidStrategy:"android",MdaStrategy:"mda"};for(let n=0;n<this.adsNames.length;n++){const i=this.adsNames[n];if(!this._adInstants.some(e=>(e=e.getStrategyName(),s[e]===i))){const s=new(0,t[i])(e,this._isReward);this._adInstants.push(s),yield s.loadAsync()}}return Promise.resolve()}catch(F){return console.info("====> load substitute ad error: ",F.message),Promise.resolve()}})}showAsync(e){if(0===this.adsNames.length)return console.info("====> No Substitute Ads's config"),Promise.reject({code:"AdsSubstitute show error",message:"No Substitute Ads's config"});try{const s=this._adInstants.find(t=>t.getStrategyName()!==e);if(!s)return Promise.reject({code:"AdsSubstitute show error",message:`${e} is the same with substitute ad`});this._curAdInstant=s;var t=this._adInstants.indexOf(s);this._adInstants.splice(t,1);const n=s.getStrategyName();return s.setAdsCallback({onShow:()=>{console.log(`====> ${n} success`)},onSuccess:()=>{console.log(`====> ${n} success`),this._refreshTotalShowTimeCallback&&this._refreshTotalShowTimeCallback()},onFail:()=>{console.log(`====> ${n} failed`)},onClick:()=>{console.log(`====> ${n} clicked`)},onClose:()=>{console.log(`====> ${n} closed`)}}),s.showAsync()}catch(t){return Promise.reject(t)}}}($t=z=z||{}).waterFall="waterFall",$t.keepBottom="keepBottom",(Ht=Lt=Lt||{}).adsense="AfgStrategy",Ht.taboola="TaboolaStrategy",Ht.android="AndroidStrategy";class Oe{constructor(e,t){this.config=null,this.isReward=!1,this.lastShowTime=0,this.enabled=!0,this.limitTime=0,this.adsWaterFall=[],this.adsKeepBottom=null,this.adsSubstitute=null,this.queue=null,this.adState=z.waterFall,this.curAds=null,this.curShowTimes=0,this.placementID="",this.isReward=e,this.config=t,this.enabled=this.config.enabled,this.limitTime=this.config.limitTime,this.adsKeepBottom=new De(this.isReward,this.config.strategy.keepBottom),this.adsSubstitute=new Ee(this.isReward,this.config.strategy.substitute),this.queue=new me,this.pushToQueue(),this.onComplete(),this.queue.play()}pushToQueue(){this.config.strategy.waterFall.forEach(e=>{this.queue.push(s=>t(this,void 0,void 0,function*(){const t=new Be(this.isReward,e,s);this.adsWaterFall.push(t),t.refreshTotalShowTimeCallback=()=>{this.lastShowTime=_.getTimeBySecond(),this.curShowTimes++}}))})}onComplete(){this.queue.complete=()=>t(this,void 0,void 0,function*(){this.adState=z.keepBottom,console.info("====> waterFall ads finish."),yield this.adsKeepBottom.loadAsync(this.placementID),console.info("====> preload keepBottom ads")})}loadAsync(e){return t(this,void 0,void 0,function*(){if(0===this.placementID.length&&(this.placementID=e),!this.enabled)return Promise.reject({code:`load ${this.isReward?"rewardAd":"interstitialAd"} error`,message:`${this.isReward?"rewardAd":"interstitialAd"} is disabled`});try{return yield this.adsSubstitute.loadAsync(e),this.adState!==z.waterFall?this.adState===z.keepBottom?this.adsKeepBottom.loadAsync(e):Promise.reject({code:"Ads load  error",message:"ad state error"}):this.adsWaterFall.find(e=>!1===e.IsFinish).loadAsync(e)}catch(F){return F.code!==I.ADS_NETWORK_NOT_FOUND?Promise.reject({code:`${this.adState} load ad error`,message:F.message}):this.adState!==z.waterFall?this.adState===z.keepBottom?this.adsKeepBottom.loadAsync(e):Promise.reject({code:"Ads load  error",message:"ad state error"}):this.adsWaterFall.find(e=>!1===e.IsFinish).loadAsync(e)}})}showAsync(){return t(this,void 0,void 0,function*(){if(!this.enabled)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} error`,message:`${this.isReward?"rewardAd":"interstitialAd"} is unable`});if(this.curShowTimes>=this.config.totalTimes&&-1!==this.config.totalTimes)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} error`,message:"had reach the max show times"});var e=_.getTimeBySecond()-this.lastShowTime;if(e<this.limitTime)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} frequently`,message:`${this.limitTime-e} seconds remain`});let t="";try{if(this.adState!==z.waterFall)return this.adState===z.keepBottom?(t=this.adsKeepBottom.getCurAdName(),this.curAds=this.adsKeepBottom,yield this.adsKeepBottom.showAsync(),this.lastShowTime=_.getTimeBySecond(),this.curShowTimes++,Promise.resolve()):Promise.reject({code:"load ad error",message:"ad state error"});{const e=this.adsWaterFall.find(e=>!1===e.IsFinish);return t=e.getCurAdName(),this.curAds=e,yield e.showAsync(),Promise.resolve()}}catch(e){if("dismissed"===e.code)return Promise.reject({code:`show ${this.isReward?"rewardAd":"interstitialAd"} error`,message:e.message});this.curAds=this.adsSubstitute;try{return yield this.adsSubstitute.showAsync(t),this.curShowTimes++,Promise.resolve()}catch(e){return Promise.reject(e)}}})}onShowAdsResult(e,t){console.info(`====> ${this.isReward?"rewardAd":"interstitialAd"} show result: ${e}, this.curAds: ${this.curAds}`),this.curAds?this.curAds.onShowAdsResult(e,t):console.error("adsController onShowAdsResult error: cur ads is null")}}class je{}class Ne extends je{constructor(){super(...arguments),this._showBannerResult=null,this._hideBannerResult=null}showBannerAsync(e){return new Promise((e,t)=>{window.AdInteractive?(window.AdInteractive.showBannerAd(),this._showBannerResult=s=>{s?e():t({code:"android show fail",message:"android show banner ads fail"})}):t("Android AdInteractive not exist")})}hideBannerAsync(){return new Promise((e,t)=>{window.AdInteractive?(window.AdInteractive.hideBannerAd(),this._hideBannerResult=s=>{s?e():t({code:"android hide fail",message:"android hide banner ads fail"})}):t("Android AdInteractive not exist")})}onShowBannerResult(e){this._showBannerResult?this._showBannerResult(e):console.error("android show banner result error")}onHideBannerResult(e){this._hideBannerResult?this._hideBannerResult(e):console.error("android hide banner result error")}}class Me extends je{constructor(){super(...arguments),this._bannerElement="minigameTaboolaBanner"}showBannerAsync(e){try{const s=document.createElement("div");s.setAttribute("id","minigameTaboolaBanner"),s.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;bottom:0;  z-index: 19999; overflow: hidden; width: 100vw;height: 80px; background-color: black;display: flex;align-items: end;justify-content: center;"),document.body.append(s);var t={containerObj:{id:"taboola-below-article-thumbnails_stream",containerStr:`#${this._bannerElement}`,ifInsertBefore:!1,propertysObj:{style:"width:320px;height:70px;overflow: hidden;background: #fff;"}},adProperties:{mode:"thumbnails-stream",container:"taboola-below-article-thumbnails_stream",placement:`Below Article Thumbnails_Stream_${window.channelName}.game.banner`}};return new we(t).showAd()}catch(e){return Promise.reject({code:"show tabool banner error",message:e.message})}}hideBannerAsync(){const e=document.getElementById(this._bannerElement);return e&&e.remove(),Promise.resolve()}}class qe{constructor(e){this._config=null,this._curBannerAd=null,this.curShowTimes=0,this._config=e}showBannerAsync(e){return t(this,void 0,void 0,function*(){if(!this._config.enabled)return Promise.reject({code:"show banner error",message:"banner is disabled"});if(this.curShowTimes>=this._config.totalTimes&&-1!==this._config.totalTimes)return Promise.reject({code:"show banner error",message:"banner show times is over"});try{const t=new(0,{taboola:Me,android:Ne}[this._config.adsName]);return this._curBannerAd=t,yield t.showBannerAsync(e),this.curShowTimes++,Promise.resolve()}catch(F){return Promise.reject(F)}})}hideBannerAsync(){return this._config.enabled?this._curBannerAd.hideBannerAsync():Promise.reject({code:"hide banner error",message:"banner is disabled"})}onShowBannerResult(e,t){var s;this._curBannerAd?null!==(s=this._curBannerAd)&&void 0!==s&&s.onShowBannerResult(e,t):console.error("ShowBanner Android Callback Error: cur bannnerAd is null")}onHideBannerResult(e,t){var s;this._curBannerAd?null!==(s=this._curBannerAd)&&void 0!==s&&s.onHideBannerResult(e,t):console.error("HideBanner Android Callback Error: cur bannnerAd is null")}}class Fe{constructor(){this._config=null}get config(){return this._config}static get instance(){return this._instance||(this._instance=new Fe),this._instance}fetchConfigAsync(e){return t(this,void 0,void 0,function*(){try{var t=e;const s=yield fetch(t);return 404===s.status?Promise.reject({code:"No_Config_File",message:"there is no config file "+t}):(this._config=yield s.json(),console.info("fetch MinigameAd config success: ",this._config),Promise.resolve())}catch(t){return Promise.reject({code:"fetch MinigameAd fail",message:t.message})}})}}Fe._instance=null;const Ue=Fe.instance,$e={adType:{interstitial:{enabled:!0,limitTime:30,totalTimes:-1,strategy:{waterFall:[{adsName:"adsense",showTimes:-1}],keepBottom:[],substitute:[]}},reward:{enabled:!0,limitTime:0,totalTimes:-1,strategy:{waterFall:[{adsName:"adsense",showTimes:-1}],keepBottom:[],substitute:[]}},banner:{enabled:!1,adsName:"taboola",totalTimes:3}}};class Le{constructor(){this.interstitialAdsController=null,this.rewardAdsController=null,this.bannerAdsController=null,this.config=null}static get instance(){return this._instance||(this._instance=new Le),this._instance}createAdInstants(){this.config=Ue.config||$e,this.rewardAdsController=new Oe(!0,this.config.adType.reward),this.interstitialAdsController=new Oe(!1,this.config.adType.interstitial),this.bannerAdsController=new qe(this.config.adType.banner)}loadAsync(e,t){return console.info("====> load AD placementId: ",e,"isReward: ",t),(t?this.rewardAdsController:this.interstitialAdsController).loadAsync(e)}showAsync(e){return console.info("====> show AD isReward: ",e),(e?this.rewardAdsController:this.interstitialAdsController).showAsync()}loadBannerAsync(e){return this.bannerAdsController.showBannerAsync(e)}hideBannerAsync(){return this.bannerAdsController.hideBannerAsync()}onShowAdsResult(e,t,s){console.info(`=====> androidCallJs onShowAdsResult isReward: ${e}, isSuccess: ${t}, message: ${s}`),(e?this.rewardAdsController:this.interstitialAdsController).onShowAdsResult(t,s)}onShowBannerResult(e,t){console.info(`=====> androidCallJs onShowBannerResult isSuccess: ${e}, errMessage: ${t}`),this.bannerAdsController.onShowBannerResult(e,t)}onHideBannerResult(e,t){console.info(`=====> androidCallJs onHideBannerResult isSuccess: ${e}, errMessage: ${t}`),this.bannerAdsController.onHideBannerResult(e,t)}}Le._instance=null;const He=Le.instance;window.showProllAsync=function(e){return ue(Z.preroll,"preroll",e)},window.onShowAdsResult=He.onShowAdsResult.bind(He),window.onShowBannerResult=He.onShowBannerResult.bind(He),window.onHideBannerResult=He.onHideBannerResult.bind(He);const ze=class e{constructor(){this._ads=[],this._curAd=null,this._curBannerAd=null}get curAd(){return this._curAd}static get instance(){return this._instance||(this._instance=new e),this._instance}loadAsync(e,s){return t(this,void 0,void 0,function*(){try{const t=new be(e,s);return this._ads.push(t),t.loadAsync()}catch(F){return Promise.reject(F)}})}showAsync(e){try{const t=this._ads.find(t=>t.getRewardedType()===e);return this._curAd=t,console.info("====> showAsync: ad ing"),t.showAsync()}catch(F){return console.info("====> showAsync error: ",F.message),Promise.reject(F)}}loadBannerAdAsync(e){try{const t=new Ne;return this._curBannerAd=t,t.showBannerAsync(e)}catch(e){return Promise.reject(e)}}hideBannerAdAsync(){try{return this._curBannerAd.hideBannerAsync()}catch(F){return Promise.reject(F)}}onShowBannerResult(e,t){this._curBannerAd.onShowBannerResult(e)}onHideBannerResult(e,t){this._curBannerAd.onHideBannerResult(e)}onShowAdsResult(e,t){console.info(`====> onShowAdsResult: isSuccess = ${e}, errMessage = ${t}`);try{this._curAd.onShowAdsResult(e,t)}catch(e){console.info("====> onShowAdsResult error: ",e.message),console.error("====> onShowAdsResult error: ",e.message)}}}.instance;window.onShowAdsResult=ze.onShowAdsResult.bind(ze),window.onShowBannerResult=ze.onShowBannerResult.bind(ze),window.onHideBannerResult=ze.onHideBannerResult.bind(ze),He.onShowAdsResult=ze.onShowAdsResult.bind(ze),He.onShowBannerResult=ze.onShowBannerResult.bind(ze),He.onHideBannerResult=ze.onHideBannerResult.bind(ze);class We{constructor(e,t,s){this.type=e,this.isOneWay=t,this._serviceHandler=s}onRequest(e){return t(this,void 0,void 0,function*(){return this._serviceHandler?this._serviceHandler(e):Promise.resolve(Ve(e))})}}function Ge(e){return`${e}_RESPONSE`}function Ke(e,t,s,n){return{type:Ge(e.type),requestType:e.type,requestId:e.requestId,code:t,message:s,payload:n}}function Ve(e,t){return Ke(e,n.OK.code,n.OK.message,t)}function Ye(e,t,s,n){return Ke(e,t,s,n)}class Je{constructor(e){this._window=e,this._messageDispatcher=this._onReceiveMessage.bind(this)}_onReceiveMessage(e){try{var t=e.data;t&&t.type&&this.dispatch(t,e.source)}catch(e){console.error("Error in receiveMessage: ",e)}}static postMessageTo(e,t,s="*"){e.postMessage(t,s)}start(){this._window.addEventListener("message",this._messageDispatcher,!1)}stop(){this._window.removeEventListener("message",this._messageDispatcher,!1)}}class Xe extends Je{constructor(e,t){super(e),this._requestCounter=0,this._pendingRequests=[],this._requestWindow=t}static createDefaultInstance(e){return this._instance||(this._instance=new Xe(window,e)),this._instance}static get instance(){if(!this._instance)throw{code:"NO_CLIENT_INSTANCE",message:"MediationClient is not initialized"};return this._instance}dispatch(e,t){const s=e,n=this._pendingRequests.find(e=>e.responseType===s.type&&e.requestId===s.requestId);n&&(this._pendingRequests=this._pendingRequests.filter(e=>!(e.responseType===s.type&&e.requestId===s.requestId)),n.onResponse&&n.onResponse(s))}invokeServiceAsync(e,t=!1){return new Promise((n,i)=>{var r;e.requestId=++this._requestCounter,t||(r={responseType:e.responseType||Ge(e.type),requestType:e.type,requestId:e.requestId,onResponse:e=>{var t;((t=e).code===s.OK||void 0===t.code||null===t.code||""===t.code?n:i)(e)}},this._pendingRequests.push(r)),Je.postMessageTo(this._requestWindow,e,"*")})}invokeQuickServiceAsync(e,t=!1,s){return this.invokeServiceAsync({type:e,payload:s},t)}}(Wt=zt=zt||{}).adsense="adsense",Wt.m150ad="m150ad",Wt.android="android";class Qe{constructor(){this._adsDataFile=""}static createDefaultInstance(){return this._instance||(this._instance=new Qe),this._instance}static get instance(){return this._instance||(this._instance=new Qe),this._instance}get strategy(){return this._adsStrategyOption}get adsShowOption(){return this._adsShowOption}fetchConfigAsync(e){return t(this,void 0,void 0,function*(){try{var t=e;const n=yield fetch(t);if(404===n.status)throw{code:"No_Config_File",message:"there is no config file "+t};var s=yield n.json();return this._adsStrategyOption=s.ad_configs,console.info("fetchAdsStrategyConfig success: ",this._adsStrategyOption),Promise.resolve()}catch(t){return Promise.reject({message:"fetchAdsConfig error: "+t.message})}})}fetchAdsData(e){return t(this,void 0,void 0,function*(){try{var t=!!(e&&0<e.length);t||console.warn("fetchAdsData error: url is null"),this._adsDataFile=t?e:"https://api.150ad.com/test/data.json";const s=yield fetch(this._adsDataFile);return this._adsShowOption=yield s.json(),console.info("fetchAdsData success: ",this._adsShowOption),Promise.resolve()}catch(t){return Promise.reject({code:"No_Ads_Data",message:"load ads data file: "+t.message})}})}fetchShowConfigAsync(e){return t(this,void 0,void 0,function*(){try{if(this._adsShowOption)return Promise.resolve(this._adsShowOption);let t=this._adsDataFile||"https://api.150ad.com/test/data.json";window.MiniGameAds&&window.MiniGameAds.isTest&&(t="https://api.150ad.com/test/data.json");const s=yield fetch(t);return this._adsShowOption=yield s.json(),console.info("fetchAdsShowConfig success: ",this._adsShowOption),Promise.resolve(this._adsShowOption)}catch(e){throw console.error("fetchShowConfig error: ",e),{code:"Fetch_Ads_Data_Error",message:"data file was "+e.message}}})}isPlatformOpen(e){var t=this.strategy.platforms.find(t=>t.id===e);return!!t&&t.enabled}}const Ze="minigameTaboolaBanner";class et{constructor(){this._ads=[]}static get instance(){return this._instance||(this._instance=new et),this._instance}loadAsync(e){return this._ads.push(e),e.loadAsync()}showAsync(){return new Promise((e,t)=>{for(let s=0;s<this._ads.length;s++)if(this._ads[s].isReady())return void this._ads[s].showAsync().then(()=>{e(),this._ads.splice(s,1)}).catch(e=>{t(e)});t("===>test ads not ready")})}showBannerAsync(e){const t=document.createElement("div");return t.setAttribute("id","minigameTaboolaBanner"),t.setAttribute("style","font-size: 16px;font-family: Microsoft YaHei;font-weight: 400; position: fixed;bottom:0;  z-index: 19999; overflow: hidden; width: 100vw;height: 80px; background-color: black;display: flex;align-items: end;justify-content: center;"),document.body.append(t),new we({containerObj:{id:"taboola-below-article-thumbnails_stream",containerStr:`#${Ze}`,ifInsertBefore:!1,propertysObj:{style:"width:320px;height:70px;overflow: hidden;background: #fff;"}},adProperties:{mode:"thumbnails-stream",container:"taboola-below-article-thumbnails_stream",placement:"Below Article Thumbnails_Stream_localTest.game.banner"}}).showAd()}hideBannerAsync(){const e=document.getElementById(Ze);return e&&e.remove(),Promise.resolve()}}let tt=et.instance;class st{static set(e,t){"object"==typeof t?localStorage.setItem(e,JSON.stringify(t)):localStorage.setItem(e,t)}static get(e,t=!0){if(e=localStorage.getItem(e)){if(t)try{return JSON.parse(e)}catch(t){return e}return e}return null}static remove(e){localStorage.removeItem(e)}static clear(){localStorage.clear()}}const nt="show_ads_count",it="shortcut_last_show_time_",rt="game_id_",ot="shortcut_show_count_",at=class e{static get instance(){return this._instance||(this._instance=new e),this._instance}setAdsShowCount(e,t){var s=_.getDate(),n=this.getAdsShowCount(e);if(n<t){n++;let t=st.get(nt,!0);if(null==t){const i={};i[""+e]=n,(t={})[s]=i}else t[s][e+""]=n;st.set(nt,t)}}getAdsShowCount(e){var t=_.getDate();const s=st.get(nt,!0);if(null==s)return 0;if(null!=s[t])return null==s[t][e+""]?(s[t][e+""]=0,st.set(nt,s),0):s[t][e+""];{st.remove(nt);const s={},n={};return n[""+e]=0,s[t]=n,st.set(nt,s),0}}setInterstitialAdsShowCount(e){var t=_.getDate();const s=this.getInterstitialAdsShowCount(e);var n=s[ot+t];n<2&&(n++,s[ot+t]=n,st.set(rt+e,s),this.setLastPlayInterstitialTime(e))}getInterstitialAdsShowCount(e){var t=_.getDate(),s=st.get(rt+e,!0);if(null==s){const s={};return s[ot+t]=0,st.set(rt+e,s),s}if(null!=s[ot+t])return s;{st.remove(rt+e),st.remove(it+e);const s={};return s[ot+t]=0,st.set(rt+e,s),s}}setLastPlayInterstitialTime(e){st.set(it+e,_.getTimestamp())}getLastPlayInterstitialTime(e){return null==(e=st.get(it+e,!0))?0:e}}.instance;class ct extends pe{constructor(){super(...arguments),this._curAd=null,this._strategyName="M150adStrategy"}loadAsync(){return Qe.instance.fetchShowConfigAsync().then(e=>t(this,void 0,void 0,function*(){if("undefined"==typeof createAdIframe)return Promise.reject({code:"Fetch_Ads_Data_Error",message:"data file was failded to load"});const t={interstitial:1,rewarded:2,preroll:1}[this.getType()],s=e.ads.filter(e=>e.type===t);if(console.info("[MiniGame Ads] suitTypeAds: ",s),0===s.length)return Promise.reject({code:"Error_Type_Ads_No_Suit_Type",message:`there is no suit type ads for ${this.getType()}|${t}`});const n=[];if(s.forEach(e=>{const t=navigator.language.toLocaleLowerCase();let s=e.support_language;0===s.length&&n.push(e),0<(s=s.filter(e=>-1!==e.toLocaleLowerCase().indexOf(t))).length&&n.push(e)}),console.info("[MiniGame Ads] suitLanguageAds: ",n),0===n.length)return Promise.reject({code:"Error_Type_Ads_No_Suit_Region",message:`there is no region type ads for ${navigator.language}`});const i=[];if(n.forEach(e=>{at.getAdsShowCount(e.id)<e.impression&&i.push(e)}),console.info("[MiniGame Ads] suitPlayTimesAds: ",i),0===i.length)return Promise.reject({code:"Error_Type_Ads_Limit_Times",message:`play times reach limit ${this.getType()}|${t}`});var r=Math.floor(Math.random()*i.length);return this._curAd=yield createAdIframe(i[r],e.ga_config.id,this.getAdsCallbackOption()),Promise.resolve()})).catch(e=>Promise.reject(e))}showAsync(){return t(this,void 0,void 0,function*(){try{return this._curAd?(yield this._curAd.showAd(),console.info("[MiniGame Ads] success to show ad"),at.setAdsShowCount(this._curAd.getAdId(),this._curAd.getPlayLimitTime()),Promise.resolve()):Promise.reject({code:"no ads",message:"[M150adStrategy] no ads"})}catch(F){return Promise.reject({code:"m150ad show error",message:F.message})}})}isReady(){return this._curAd&&this._curAd.ready}}class dt extends ct{constructor(){super(...arguments),this._strategyName="TestAdsStrategy"}loadAsync(){return Qe.instance.fetchShowConfigAsync().then(e=>t(this,void 0,void 0,function*(){var t=e.ads,s=Math.floor(Math.random()*t.length);const n=new Te(t[s],e.ga_config.id,this.getAdsCallbackOption());return this._curAd=yield n.initAsync(),console.info("test ads load success"),Promise.resolve()})).catch(e=>(console.info("test ads load err: ",e.message),Promise.reject(e)))}}class lt extends We{static createRequest(e){return{type:lt.requestType,payload:e}}static createService(){return new lt(lt.requestType,!1,lt.handleRequestAsync)}static handleRequestAsync(e){var t=e.payload.placementId,s=e.payload.isRewardedAd;return e.payload.uid,He.loadAsync(t,s).then(()=>(console.info("====>load Ads success"),Promise.resolve(Ve(e)))).catch(t=>Promise.resolve(Ye(e,t.code,t.message)))}}lt.requestType="AFGAdInstantLoadService";class ht extends We{static createService(){return new ht(ht.requestType,!1,ht.handleRequestAsync)}static createRequest(e){return{type:ht.requestType,payload:e}}static handleRequestAsync(e){return t(this,void 0,void 0,function*(){var t=e.payload.isRewardedAd?Z.reward:Z.next,s=e.payload.placementId;return e.payload.uid,console.info(`===> show ad: ${t}|${s}`),He.showAsync(e.payload.isRewardedAd).then(()=>(console.info("====>show ads: success"),Promise.resolve(Ve(e)))).catch(t=>(console.info("====>showAdsStrategy show ads: failed: ",t),Promise.resolve(Ye(e,t.code,t.message))))})}}ht.requestType="AFGAdInstantShowService";class ut{constructor(e){this._isRewardedAd=!1,this._uid="",this._placementId=e,this._isRewardedAd=!1,this._uid=(new Date).getTime().toString()}static create(e,t){const s=new ut(e);return s.setRewardedType(t),s}setRewardedType(e){this._isRewardedAd=e}getPlacementID(){return this._placementId}loadAsync(){var e={isRewardedAd:this._isRewardedAd,placementId:this._placementId,uid:this._uid};if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info(`====> Android invoke load ${this._isRewardedAd?"reward":"interstitial"} ad`),ze.loadAsync(this._placementId,this._isRewardedAd)}catch(e){return Promise.reject(e)}if(window.MiniGameAds&&window.MiniGameAds.isTest){Qe.createDefaultInstance();var t=L.INTERSTITIAL;return t=new dt(this._placementId,!1,t,!0),et.instance.loadAsync(t).then(()=>(console.info("test ad load service return success"),Promise.resolve())).catch(e=>(console.info("test ad load service return error: ",e),Promise.reject(e)))}return Xe.instance.invokeServiceAsync(lt.createRequest(e)).then(()=>Promise.resolve()).catch(e=>(console.info("Ad load service return error: ",e),Promise.reject(e)))}showAsync(){var e={isRewardedAd:this._isRewardedAd,placementId:this._placementId,uid:this._uid};if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info(`====> Android invoke show ${this._isRewardedAd?"reward":"interstitial"} ad`),ze.showAsync(this._isRewardedAd)}catch(e){return Promise.reject(e)}return window.MiniGameAds&&window.MiniGameAds.isTest?et.instance.showAsync().then(()=>(console.info("test ad show service return success"),Promise.resolve())).catch(e=>(console.info("test ad show service return error: ",e),Promise.reject(e))):Xe.instance.invokeServiceAsync(ht.createRequest(e)).then(()=>Promise.resolve()).catch(e=>(console.info("Ad show service return error: ",e),Promise.reject(e)))}}class mt{getID(){return"0"}getContextID(){return"0"}getEndTime(){return 0}getTitle(){return""}getPayload(){return""}}var pt=new class{postScoreAsync(e){return Promise.resolve()}createAsync(e){return i.emptyWaitObject(new mt)}shareAsync(e){return Promise.resolve()}joinAsync(e){return Promise.resolve()}getTournamentsAsync(){return i.emptyWaitObject([])}};const gt=new class{getCatalogAsync(){return i.emptyWaitObject([])}purchaseAsync(e){return i.emptyWaitObject(null)}getPurchasesAsync(){return i.emptyWaitObject([])}consumePurchaseAsync(e){return i.emptyWaitObject(null)}onReady(e){e()}};class yt{constructor(){this._payType="",this.getAvailableGoodsResult=null,this.queryUnConsumeOrderResult=null,this.payResult=null,this.consumeOrderResult=null}getCatalogAsync(){return new Promise((e,t)=>{const s=window.AdInteractive;s||t("Android AdInteractive is not exist"),s.getAvailableGoods(),this.getAvailableGoodsResult=(s,n,i)=>{if(s){console.info("====> getAvailableGoodsResult productInfos: ",n);const t=JSON.parse(n),s=[];t.forEach(e=>{const t={};t.title=e.goodsName,t.description="",t.imageURI="",t.price=e.amount,t.priceCurrencyCode=e.currencyCode,t.productID=e.goodsId,s.push(t)}),e(s)}else t({code:"android_getCatelogAsync_error",message:`${i}`})}})}purchaseAsync(e){return new Promise((t,s)=>{const n=window.AdInteractive;var i;n?(i=v(),n.pay(e.productID,i),this.payResult=(n,i,r,o)=>{if(n){const s={};s.productID=e.productID,s.paymentID="",s.purchaseToken=i,s.purchaseTime=_.getTimestamp().toString(),s.signedRequest="",s.developerPayload=e.developerPayload,this._payType=r,t(s)}else s({code:"android_purchaseAsync_error",message:`${o}`})}):s("Android AdInteractive is not exist")})}getPurchasesAsync(){return new Promise((e,t)=>{const s=window.AdInteractive;s?(s.queryUnConsumeOrder(),this.queryUnConsumeOrderResult=(s,n,i)=>{if(s){console.info("====> queryUnConsumeOrderResult productInfos: ",n);const t=JSON.parse(n),s=[];t.forEach(e=>{const t={};t.purchaseToken=e.id,t.paymentID=e.thirdUid,t.purchaseTime=_.getTimestamp().toString(),t.productID=e.productId,t.signedRequest="",s.push(t)}),e(s)}else t({code:"android_getPurchasesAsync_error",message:`${i}`})}):t("Android AdInteractive is not exist")})}consumePurchaseAsync(e){return new Promise((t,s)=>{const n=window.AdInteractive;n?(n.consume(e,this._payType),this.consumeOrderResult=(e,n)=>{e?t():s({code:"android_consumePurchaseAsync_error",message:`${n}`})}):s("Android AdInteractive is not exist")})}onReady(e){e&&e()}onGetAvailableGoodsResult(e,t,s){console.info(`====> onGetAvailableGoodsResult isSuccess: ${e}, productInfos: ${t}, errorMessage: ${s}`),this.getAvailableGoodsResult?this.getAvailableGoodsResult(e,t,s):console.info("====> getAvailableGoodsResult is not init")}onQueryUnConsumeOrderResult(e,t,s){console.info(`====> onQueryUnConsumeOrderResult isSuccess: ${e}, productInfos: ${t}, errorMessage: ${s}`),this.queryUnConsumeOrderResult?this.queryUnConsumeOrderResult(e,t,s):console.info("====> queryUnConsumeOrderResult is not init")}onPayResult(e,t,s,n){console.info(`====> onPayResult isSuccess: ${e}, orderId: ${t}, errorMessage: ${n}`),this.payResult?this.payResult(e,t,s,n):console.info("====> payResult is not init")}onConsumeOrderResult(e,t){console.info(`====> onComsumeOrderResult isSuccess: ${e}, errorMessage: ${t}`),this.consumeOrderResult?this.consumeOrderResult(e,t):console.info("====> onComsumeOrderResult is not init")}}class ft{constructor(){this._payment=null}static get instance(){return this._instance||(this._instance=new ft),this._instance}init(){var e=window.AdInteractive;this._payment=e?new yt:gt}getCatalogAsync(){return this._payment.getCatalogAsync()}purchaseAsync(e){return this._payment.purchaseAsync(e)}getPurchasesAsync(){return this._payment.getPurchasesAsync()}consumePurchaseAsync(e){return this._payment.consumePurchaseAsync(e)}onReady(e){this._payment.onReady(e)}onGetAvailableGoodsResult(e,t,s){var n;this._payment&&null!==(n=this._payment)&&void 0!==n&&n.onGetAvailableGoodsResult(e,t,s)}onQueryUnConsumeOrderResult(e,t,s){var n;this._payment&&null!==(n=this._payment)&&void 0!==n&&n.onQueryUnConsumeOrderResult(e,t,s)}onPayResult(e,t,s,n){var i;this._payment&&null!==(i=this._payment)&&void 0!==i&&i.onPayResult(e,t,s,n)}onConsumeOrderResult(e,t){var s;this._payment&&null!==(s=this._payment)&&void 0!==s&&s.onConsumeOrderResult(e,t)}}ft._instance=null;const wt=ft.instance;window.onGetAvailableGoodsResult=wt.onGetAvailableGoodsResult.bind(wt),window.onQueryUnConsumeOrderResult=wt.onQueryUnConsumeOrderResult.bind(wt),window.onPayResult=wt.onPayResult.bind(wt),window.onConsumeOrderResult=wt.onConsumeOrderResult.bind(wt);class At extends We{static createRequest(){return{type:At.requestType}}static createService(){return new At(At.requestType,!1,At.handleRequestAsync)}static handleRequestAsync(e){return wt.getCatalogAsync().then(t=>Promise.resolve(Ve(e,JSON.stringify(t)))).catch(t=>Promise.reject(Ye(e,t.code,t.message)))}}At.requestType="PayInstantCatalogService";class vt extends We{static createRequest(e){return{type:vt.requestType,payload:e}}static createService(){return new vt(vt.requestType,!1,vt.handleRequestAsync)}static handleRequestAsync(e){return wt.purchaseAsync(e.payload).then(t=>Promise.resolve(Ve(e,t))).catch(t=>Promise.reject(Ye(e,t.code,t.message)))}}vt.requestType="PayInstantPurchasesService";class _t extends We{static createRequest(){return{type:_t.requestType}}static createService(){return new _t(_t.requestType,!1,_t.handleRequestAsync)}static handleRequestAsync(e){return wt.getPurchasesAsync().then(t=>Promise.resolve(Ve(e,t))).catch(t=>Promise.reject(Ye(e,t.code,t.message)))}}_t.requestType="PayInstantGetPurchasesService";class bt extends We{static createRequest(e){return{type:bt.requestType,payload:e}}static createService(){return new bt(bt.requestType,!1,bt.handleRequestAsync)}static handleRequestAsync(e){var t=e.payload;return wt.consumePurchaseAsync(t).then(()=>Promise.resolve(Ve(e))).catch(t=>Promise.reject(Ye(e,t.code,t.message)))}}bt.requestType="PayInstantConsumePurchaseService";class St extends We{static createRequest(e){return{type:St.requestType,payload:e}}static createService(){return new St(St.requestType,!1,St.handleRequestAsync)}static handleRequestAsync(e){return wt.onReady(e.payload),Promise.resolve(Ve(e))}}function Pt(e){return t(this,void 0,void 0,function*(){try{var t=e||function(){const e=new URLSearchParams(window.location.search);let t="minigame-config.json",s=!1;var n;return e.has("mn_config")&&(t=e.get("mn_config"),console.debug("[minigame] config: ",t),s=!0),!s&&e.has("mn_channel")&&(n=e.get("mn_channel"),console.debug("[minigame] channel: ",n),t=n+"-config.json"),t}();if(window.AdInteractive){var s=(i=t,yield new Promise((e,t)=>{const s=new XMLHttpRequest;s.open("GET",i),s.onload=function(){var n;200===s.status?(n=JSON.parse(s.responseText),console.info("config loaded:",n),e(n)):t({message:`fail to get config data from ${i}`})},s.onerror=function(){t({message:"fail to get config data from : "+s.statusText})},s.send()}));return Promise.resolve(s)}{const e=yield fetch(t);var n=yield e.json();return Promise.resolve(n)}}catch(t){return console.error("[minigame] load minigame option error: ",t),Promise.reject(t)}var i})}St.requestType="PayInstantOnReadyService",window.gaEvent=null;let xt=!1;const It={version:Gt="1.2.9 b009",init:function(){return t(this,void 0,void 0,function*(){if(xt)throw{code:"SDK_ALREADY_INIT",message:"Minigame Sdk has been initialized"};try{var e=yield Pt();console.info("[minigame] initSdkAsync options:",e);try{e.ga&&!e.ga.disabled&&function(e){function t(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||t;var s=e.config.gid;s?(console.info("[minigame] init ga with id: "+s),D("https://www.googletagmanager.com/gtag/js?id="+s,!0,e.attributes).then(()=>{}).catch(e=>{console.error("[minigame] init ga error: ",e)}),t("js",new Date),t("config",s,{cookie_flags:"max-age=7200;secure;samesite=none"})):console.warn("[minigame] ga with invalid id: "+s)}(e.ga)}catch(e){console.error("[minigame] initGa error:",e)}try{var s=e.instana;s&&s.enabled&&s.key&&(n=s.key,i=e.app_id,n&&0!==n.length?(console.info("enable instana for game: ",i),r=window,o="ineum",r.InstanaEumObject||(r.InstanaEumObject=o,(a=r[o]=function(){a.q.push(arguments)}).q=[],a.v=2,a.l=+new Date),window.ineum("reportingUrl","https://eum-orange-saas.instana.io"),window.ineum("key",n),window.ineum("trackSessions"),D("https://eum.instana.io/eum.min.js",!1,{crossorigin:"anonymous",defer:!0}),i&&window.ineum("page","minigame#"+i)):console.warn("[minigame] init instana with invalid token: ",n))}catch(e){}try{e.vconsole&&function(){t(this,void 0,void 0,function*(){window.VConsole?console.info("[minigame] vconsole already loaded"):yield D("https://unpkg.com/vconsole/dist/vconsole.min.js",!1),window.vConsoleInstance=new window.VConsole})}()}catch(e){console.error("[minigame] initVConsole error:",e)}xt=!0}catch(e){console.error("Fail to load config file",e)}var n,i,r,o,a})},isReady:()=>xt};console.info("minigame sdk: "+Gt);class kt extends We{static createRequest(e){return{type:kt.requestType,payload:e}}static createService(){return new kt(kt.requestType,!1,kt.handleRequestAsync)}static handleRequestAsync(e){return He.loadBannerAsync(e.payload).then(()=>Promise.resolve(Ve(e))).catch(t=>Promise.reject(Ye(e,t.code,t.message)))}}kt.requestType="BannerShowService";class Tt extends We{static createRequest(){return{type:Tt.requestType}}static createService(){return new Tt(Tt.requestType,!1,Tt.handleRequestAsync)}static handleRequestAsync(e){return He.hideBannerAsync().then(()=>Promise.resolve(Ve(e))).catch(t=>Promise.reject(Ye(e,t.code,t.message)))}}Tt.requestType="BannerHideService";class Ct{getChannelID(){return""}getInstanceID(){return""}getStateAsync(){return i.emptyWaitObject({show:!1,docked_location:"TOP_LEFT"})}getDisplayRectAsync(){return i.emptyWaitObject({x:0,y:0,width:0,height:0})}setState(e){}destroy(){}}const Rt=class e{constructor(){this._shareResult=null}static get instance(){return this._instance||(this._instance=new e),this._instance}shareAsync(e){return new Promise((t,s)=>{var n;window.AdInteractive?(console.info("====> AdInteractive.share : ",e),window.AdInteractive.share(e.image,null===(n=e.media)||void 0===n?void 0:n.gif.url,null===(n=e.media)||void 0===n?void 0:n.video.url),this._shareResult=(e,n)=>{console.info(`====> onShareResult isSuccess: ${e}`),e?t():s({code:"android share fail",message:n})}):(console.info("====> android share fail by no AdInteractive"),s({code:"android share fail",message:"android share fail by no AdInteractive"}))})}onShareResult(e,t){this._shareResult?this._shareResult(e,t):console.error(`onShareResult === isSuccess : ${e}, errMessage : ${t}`)}}.instance;window.onShareResult=Rt.onShareResult.bind(Rt);class Bt{constructor(){this._products=[],this._purchasesUnconsumed=[]}static getInstance(){return null==this._instance&&(this._instance=new Bt),this._instance}addProduct(e,s){return t(this,void 0,void 0,function*(){const t={};t.productID=e,t.price=s||"",t.priceCurrencyCode="USD",t.title="",t.description="",t.imageURI="",this._products.push(t);const n={};n.products=this._products,yield Y.setDataAsync(n),console.info(`====> addProduct success, products : ${JSON.stringify(this._products)}`)})}getCatalogAsync(){return t(this,void 0,void 0,function*(){try{var e=yield Y.getDataAsync(["products"]);return this._products=[],e.products&&0<e.products.length&&(this._products=this._products.concat(e.products)),console.info("====> test getCatalogAsync success, products : "+JSON.stringify(this._products)),i.emptyWaitObject(this._products)}catch(e){return console.error(`====> test getCatalogAsync fail : ${e}`),Promise.reject(e)}})}purchaseAsync(e){return t(this,void 0,void 0,function*(){try{const t=e.productID;this._products.find(e=>e.productID===t);const s={};s.productID=t,s.paymentID="",s.purchaseToken=_.getTimestamp().toString(),s.purchaseTime=_.getTimestamp().toString(),s.signedRequest="",s.developerPayload=e.developerPayload,yield this.getPurchasesAsync(),this._purchasesUnconsumed.push(s);const n={};return n.purchasesUnconsumed=this._purchasesUnconsumed,yield Y.setDataAsync(n),console.info(`====> purchaseAsync success, purchasesUnconsumed : ${JSON.stringify(this._purchasesUnconsumed)}`),Promise.resolve(s)}catch(F){return console.error(`====> purchaseAsync fail : ${F}`),Promise.reject(F)}})}getPurchasesAsync(){return this.getPurchasesUnconsumed()}consumePurchaseAsync(e){return t(this,void 0,void 0,function*(){try{var t=this._purchasesUnconsumed.findIndex(t=>t.purchaseToken===e);this._purchasesUnconsumed.splice(t,1)[0];const s={};return s.purchasesUnconsumed=this._purchasesUnconsumed,yield Y.setDataAsync(s),console.info(`====> consumePurchaseAsync success, purchasesUnconsumed : ${JSON.stringify(this._purchasesUnconsumed)}`),Promise.resolve()}catch(t){return console.error(`====> consumePurchaseAsync fail : ${t}`),Promise.reject(t)}})}onReady(e){e&&e()}getPurchasesUnconsumed(){return t(this,void 0,void 0,function*(){try{var e=yield Y.getDataAsync(["purchasesUnconsumed"]);return e.purchasesUnconsumed&&0<e.purchasesUnconsumed.length&&(this._purchasesUnconsumed=[],this._purchasesUnconsumed=this._purchasesUnconsumed.concat(e.purchasesUnconsumed)),console.info("====> test getPurchasesUnconsumed success, purchasesUnconsumed : "+JSON.stringify(this._purchasesUnconsumed)),i.emptyWaitObject(this._purchasesUnconsumed)}catch(e){return console.error(`====> test getPurchasesUnconsumed fail : ${e}`),Promise.reject(e)}})}}Bt._instance=null;const Dt=Bt.getInstance();class Et extends We{static createRequest(e){return{type:Et.requestType,payload:e}}static createService(){return new Et(Et.requestType,!1,Et.handleRequestAsync)}static handleRequestAsync(e){return Rt.shareAsync(e.payload).then(()=>Promise.resolve(Ve(e))).catch(t=>Promise.resolve(Ye(e,t.code,t.message)))}}Et.requestType="ShareService";class Ot{static get instance(){return null==this._instance&&(this._instance=new Ot),this._instance}getCatalogAsync(){return console.info("===========> getCatalogAsync"),Xe.instance.invokeServiceAsync(At.createRequest()).then(e=>(console.info("===========> getCatalogAsync success"),Promise.resolve(e.payload))).catch(e=>(console.error("===========> getCatalogAsync fail "+e.message),Promise.reject({code:"getCatalogAsync fail",message:e.message})))}purchaseAsync(e){return console.info("===========> purchaseAsync"),Xe.instance.invokeServiceAsync(vt.createRequest(e)).then(t=>(console.info(`===========> purchaseAsync ${e.productID} success`),console.info(`===========> purchaseAsync payload: ${JSON.stringify(t.payload)}`),Promise.resolve(t.payload))).catch(t=>(console.error(`===========> purchaseAsync ${e.productID} ${t.message}`),Promise.reject({code:"purchaseAsync fail",message:t.message})))}getPurchasesAsync(){return console.info("===========> getPurchasesAsync"),Xe.instance.invokeServiceAsync(_t.createRequest()).then(e=>(console.info("===========> getPurchasesAsync success"),Promise.resolve(e.payload))).catch(e=>(console.error("===========> getPurchasesAsync "+e.message),Promise.reject({code:"getPurchasesAsync fail",message:e.message})))}consumePurchaseAsync(e){return console.info("===========> consumePurchaseAsync"),Xe.instance.invokeServiceAsync(bt.createRequest(e)).then(()=>(console.info(`===========> consumePurchaseAsync ${e} success`),Promise.resolve())).catch(t=>(console.error(`===========> consumePurchaseAsync ${e} ${t.message}`),Promise.reject({code:"consumePurchaseAsync fail",message:t.message})))}onReady(e){return t(this,void 0,void 0,function*(){console.info("===========> onReady"),yield Xe.instance.invokeServiceAsync(St.createRequest(e)).then(()=>{console.info("===========> onReady success")}).catch(e=>{console.error("===========> onReady fail "+e.message)})})}}Ot._instance=null;const jt=Ot.instance;let Nt,Mt,qt;var Ft=class{static requestAsync(e,t,s){return i.emptyWaitUnsupportApi("FBInstant.graphApi.requestAsync")}},Ut=class{static getArenasAsync(){return i.emptyWaitObject([])}},$t=class{static getAsync(e){return i.emptyWaitObject(null)}static createAsync(e){return i.emptyWaitObject(null)}static getPlayerSquadsAsync(){return i.emptyWaitObject([])}static canUseSquadsAsync(){return i.emptyWaitObject(!1)}},Lt=class{static canGetLiveStreamsAsync(){return i.emptyWaitObject(!1)}static canFollowOfficialPageAsync(){return i.emptyWaitObject(!1)}static canJoinOfficialGroupAsync(){return i.emptyWaitObject(!1)}static getLiveStreamsAsync(e){return i.emptyWaitObject([])}static liveStreamsOverlayAsync(){return i.emptyWait()}static followOfficialPageAsync(){return i.emptyWait()}static joinOfficialGroupAsync(){return i.emptyWait()}},Ht=class{static createAsync(e,t){return i.emptyWaitObject(null)}static getInstancesAsync(){return i.emptyWaitObject([])}},zt=class{static showAsync(){return i.emptyWait()}static getCurrentMatchAsync(){return i.emptyWaitObject(null)}static loadCameraEffectAsync(e){return i.emptyWaitObject(null)}static clearCameraEffectAsync(){return i.emptyWait()}},Wt=class{static createAsync(e){return i.emptyWaitObject(new Ct)}},Gt=class{static unlockItemAsync(e){return i.emptyWaitUnsupportApi("FBInstant.inventory.unlockItemAsync")}};Gt=Object.freeze({get player(){return Nt},get context(){return Mt},get payments(){return qt},getLocale:function(){return navigator.language},getPlatform:function(){return void 0===A&&(e=navigator.userAgent||navigator.vendor||window.opera,A=!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))),A?"MOBILE_WEB":"WEB";var e},getSDKVersion:function(){return"7.0"},initializeAsync:function(){return t(this,void 0,void 0,function*(){try{Xe.instance.invokeQuickServiceAsync("MINIGAME_INIT",!0),yield Q(()=>It.isReady()),Nt=X.currentPlayer,Mt=d.currentContext}catch(F){console.error("initializeAsync error:",F)}return i.emptyWait()})},setLoadingProgress:function(e){"number"!=typeof e&&(e=parseFloat(e)),e=isNaN(e)?0:e,e=Math.min(100,e),e=Math.max(0,e),Xe.instance&&Xe.instance.invokeQuickServiceAsync("MINIGAME_PROGRESS",!0,{progress:e})},getSupportedAPIs:function(){return["getLocale","getPlatform","getSDKVersion","getSupportedAPIs","getEntryPointData","logEvent","onPause","inventory.unlockItemAsync","matchPlayerAsync","initializeAsync","setLoadingProgress","setSessionData","startGameAsync","player.getID","player.getName","player.getPhoto","player.flushDataAsync","player.getDataAsync","player.setDataAsync","player.subscribeBotAsync","player.getConnectedPlayersAsync","player.getSignedPlayerInfoAsync","player.canSubscribeBotAsync","player.getStatsAsync","player.setStatsAsync","player.incrementStatsAsync","context.getID","context.getType","context.isSizeBetween","context.switchAsync","context.chooseAsync","context.createAsync","context.getPlayersAsync","payments.getCatalogAsync","payments.purchaseAsync","payments.getPurchasesAsync","payments.consumePurchaseAsync","payments.onReady","getInterstitialAdAsync","getRewardedVideoAsync","loadBannerAdAsync","hideBannerAdAsync","shareAsync","switchGameAsync","quit","canCreateShortcutAsync","createShortcutAsync","getEntryPointAsync","getLeaderboardAsync","checkCanPlayerMatchAsync","postSessionScore","updateAsync"]},getEntryPointData:function(){return{}},getEntryPointAsync:function(){return i.emptyWaitString("UNKNOWN")},setSessionData:function(){},startGameAsync:function(){return Xe.instance.invokeQuickServiceAsync("MINIGAME_START_GAME",!0),qt=window.MiniGameAds&&window.MiniGameAds.isTest?(console.info("====> MiniGameAds is test mode"),Dt):(console.info("====> MiniGameAds is normal mode"),jt),i.emptyWait()},shareAsync:function(e){return window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp?Rt.shareAsync(e):Xe.instance.invokeServiceAsync(Et.createRequest(e)).then(()=>Promise.resolve()).catch(t=>(console.info(`shareAsync ${e} error: `,t),Promise.reject(t)))},updateAsync:function(){return i.emptyWait()},switchGameAsync:function(){return i.emptyWait()},canCreateShortcutAsync:function(){return i.emptyWaitBool(!1)},createShortcutAsync:function(){return i.emptyWait()},quit:function(){},logEvent:function(e,t,s){if(void 0===window.gaEvent)return console.warn("===> gaEvent not init"),{};let n,i,r;console.info("logging event: ",e,s),s&&(n=s.category,i=s.label,r=s.nonInteraction);const o=window.gtag;return o&&o("event",e,{event_category:n,event_label:i,non_interaction:r||!0}),{}},onPause:function(){},getInterstitialAdAsync:function(e){return i.emptyWaitObject(ut.create(e,!1))},getRewardedInterstitialAsync:function(e){return i.emptyWaitObject(ut.create(e,!1))},getRewardedVideoAsync:function(e){return i.emptyWaitObject(ut.create(e,!0))},matchPlayerAsync:function(){return i.emptyWait()},checkCanPlayerMatchAsync:function(){return i.emptyWaitBool(!1)},getLeaderboardAsync:function(){return i.emptyWaitUnsupportApi("FBInstant.getLeaderboardAsync")},postSessionScore:function(){},bCustomInit:!0,loadBannerAdAsync:function(e){if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info("====> Android invoke loadBannerAdAsync"),ze.loadBannerAdAsync(e)}catch(F){return console.info("====> Android invoke loadBannerAdAsync error: ",F.messgae),Promise.reject(F)}return window.MiniGameAds&&window.MiniGameAds.isTest?tt.showBannerAsync(e):Xe.instance.invokeServiceAsync(kt.createRequest(e)).then(()=>Promise.resolve()).catch(t=>(console.info(`banner ${e} show error: `,t),Promise.reject(t)))},hideBannerAdAsync:function(){if(window.AdInteractive&&window.MiniGameAds&&window.MiniGameAds.isAndroidApp)try{return console.info("====> Android invoke hideBannerAdAsync"),ze.hideBannerAdAsync()}catch(F){return console.info("====> Android invoke hideBannerAdAsync error: ",F.messgae),Promise.reject(F)}return window.MiniGameAds&&window.MiniGameAds.isTest?tt.hideBannerAsync():Xe.instance.invokeServiceAsync(Tt.createRequest()).then(()=>Promise.resolve()).catch(e=>(console.info("banner hide error: ",e),Promise.reject(e)))},tournament:pt,getTournamentAsync:function(){return i.emptyWaitObject(new mt)},canSwitchNativeGameAsync:function(){return i.emptyWaitBool(!1)},postSessionScoreAsync:function(){},inviteAsync:function(){return i.emptyWaitUnsupportApi("FBInstant.inviteAsync")},graphApi:Ft,arenas:Ut,squads:$t,community:Lt,videoPlayer:Ht,room:zt,liveVideoCommentView:Wt,inventory:Gt}),Xe.createDefaultInstance(window.parent),Xe.instance.start(),window.FBInstant=Gt,window.minigame_sdk=It,window.mediationClient=Xe.instance,It.init()});